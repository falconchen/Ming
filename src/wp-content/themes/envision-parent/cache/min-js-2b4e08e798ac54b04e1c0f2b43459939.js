(function($){$.fn.serializeObject=function()
{var o={};var a=this.serializeArray();$.each(a,function(){if(o[this.name]!==undefined){if(!o[this.name].push){o[this.name]=[o[this.name]];}
o[this.name].push(this.value||'');}else{o[this.name]=(this.value||'');}});return o;};$.fn.center=function(){this.css('position','absolute');this.css('top',(($(window).height()-this.outerHeight())/2)+$(window).scrollTop()+'px');this.css('left',(($(window).width()-this.outerWidth())/2)+$(window).scrollLeft()+'px');return this;}})(jQuery);(function($){$.fn.reddit=function(){if(this.is(':visible')){curr=this;}
else{curr=this.parent();}
current_bg_color=curr.css('background-color');curr.css('background-color','red').animate({'background-color':current_bg_color},1000);return false;}})(jQuery);(function($){$.fn.selectRange=function(start,end){return this.each(function(){if(this.setSelectionRange){this.focus();this.setSelectionRange(start,end);}else if(this.createTextRange){var range=this.createTextRange();range.collapse(true);range.moveEnd('character',end);range.moveStart('character',start);range.select();}});}})(jQuery);function stripos(f_haystack,f_needle,f_offset){var haystack=(f_haystack+'').toLowerCase();var needle=(f_needle+'').toLowerCase();var index=0;if((index=haystack.indexOf(needle,f_offset))!==-1){return index;}
return false;}
function uniqid(){if(typeof uniqid.id=='undefined')
uniqid.id=0;else
uniqid.id++;return uniqid.id;}
function tf_clean_post_names(post_object,recursion){if(recursion===undefined)recursion=false;if((typeof post_object)!='object')return post_object;var result=(recursion?[]:{});for(var id in post_object){result[jQuery.trim(id).replace(/\[\]$/,'')]=((typeof post_object[id])=='object'?tf_clean_post_names(post_object[id],true):post_object[id]);}
return result;}
function tf_form_bind_ajax_submit(form,data)
{var $=jQuery;var Data=data;return $(form).submit(function(){showLoading();var data=$.extend({options:JSON.stringify(tf_clean_post_names($(this).serializeObject())),_ajax_nonce:tf_script.ajax_admin_save_options_nonce},Data);$.ajax({type:'POST',url:tf_script.ajaxurl,data:data,dataType:"json",success:function(response){showFinishedLoading();if(response!=null&&response.reload_page==true){setTimeout(function(){window.location.reload();},1000);}},error:function(XMLHttpRequest,textStatus,errorThrown){showFailLoading();}});return false;});}
function tf_init_google_maps_input(_this)
{var $=jQuery;var El=(_this!==undefined?$(_this):$(this));var iD=El.attr('id');var inputX=$('input#'+iD+'_x');var inputY=$('input#'+iD+'_y');var mapDiv=$('#'+iD+'_map');new(function(){this.marker=null;this.map=null;this.LatLng=null;this.isMoving=false;this.__construct=function()
{var x=inputX.val();x=(This.isFloat(x)?parseFloat(x):null);var y=inputY.val();y=(This.isFloat(y)?parseFloat(y):null);if(x!==null&&y!==null){var mapCenter=new google.maps.LatLng(x,y);var mapZoom=7;This.LatLng=mapCenter;}else{var mapCenter=new google.maps.LatLng(0,0);var mapZoom=2;This.LatLng=null;}
This.map=new google.maps.Map(document.getElementById(mapDiv.attr('id')),{zoom:mapZoom,center:mapCenter,mapTypeId:google.maps.MapTypeId.ROADMAP,streetViewControl:false});This.setMarker(x,y);google.maps.event.addListener(This.map,'click',function(event){This.setMarker(event.latLng);});google.maps.event.addListener(This.map,'mousedown',function(event){This.isMoving=true;});google.maps.event.addListener(This.map,'mouseup',function(event){setTimeout(function(){This.isMoving=false;},30);});google.maps.event.addListener(This.map,'mouseout',function(event){This.isMoving=false;});(function(){var changeFunction=function(){var x=inputX.val();x=(This.isFloat(x)?parseFloat(x):null);var y=inputY.val();y=(This.isFloat(y)?parseFloat(y):null);if(x!==null&&y!==null){var tmp=new google.maps.LatLng(x,y);El.val(tmp.lat()+':'+tmp.lng());This.setMarker(x,y,true);}else{El.val('');if(This.marker!==null){This.marker.setMap(null);}}};inputX.bind('blur change keyup',changeFunction);inputY.bind('blur change keyup',changeFunction);})();};this.setMarker=function(x,y,iAmFromChange){var newPoint=null;if(typeof(x)=='object'){newPoint=x;}else{x=(This.isFloat(x)?parseFloat(x):null);y=(This.isFloat(y)?parseFloat(y):null);if(x!==null&&y!==null){newPoint=new google.maps.LatLng(x,y);}}
if(newPoint!==null){if(This.marker===null){This.marker=new google.maps.Marker({position:newPoint,map:This.map,draggable:true,animation:google.maps.Animation.DROP});google.maps.event.addListener(This.marker,'dragend',function(event){This.setMarker(event.latLng);});}else{This.marker.setMap(This.map);This.marker.setPosition(newPoint);}
inputX.val(newPoint.lat());inputY.val(newPoint.lng());if(iAmFromChange!==undefined){}else{inputX.trigger('change');}
return true;}else{if(This.marker!==null){This.marker.setMap(null);}
return false;}};this.isFloat=function(value){if($.trim(value)=='')return false;value=parseFloat(value);if(String(value)=='NaN'){return false;}
return true;};if(typeof(google)=='undefined'){mapDiv.html('Error: goolge API cannot be loaded');return;}
var This=this;if(mapDiv.is(":visible")){This.__construct();}
(function(){var resizeFunction=function(){if(This.isMoving)return;google.maps.event.trigger(This.map,'resize');if(This.marker!==null){This.map.setCenter(This.marker.getPosition());}};var mapDivState=mapDiv.is(":visible");var click_function=function(){if(This.map===null&&mapDiv.is(":visible")){This.__construct();}
var newState=mapDiv.is(":visible");if(mapDivState!=newState){mapDivState=newState;if(newState){resizeFunction();}}};$(document.body).click(click_function).on('change','select',click_function);var interval=setInterval(function(){var tabs=$('.ui-tabs-nav',mapDiv.closest('.tf_meta_tabs'));mapDivState=false;if(tabs.length){$('a',tabs).click(click_function);click_function();clearInterval(interval);}},1000);})();})();};Object.keys=Object.keys||function(o){var result=[];for(var name in o){if(o.hasOwnProperty(name))
result.push(name);}
return result;};var TUtils={intval:function(value)
{value=parseInt(value);return!isNaN(value)?value:0;},int_or_string_val:function(value)
{if(value===undefined||value===null){return 0;}
var int_value;if(!isNaN(int_value=parseInt(value))){return int_value;}
return String(value);},id_uniq:function()
{return'iD'+this.md5uniq();},md5uniq:function()
{return this.MD5(this.random_string()+this.random_string()+this.random_string()+(new Date()).getTime());},random_string:function()
{return Math.floor((1+Math.random())*0x100000000).toString(16).substring(1);},object_length:function(hash)
{var length=0;for(var key in hash){if(hash.hasOwnProperty(key))length++;}
return length;},MD5:function(string)
{function RotateLeft(lValue,iShiftBits){return(lValue<<iShiftBits)|(lValue>>>(32-iShiftBits));}
function AddUnsigned(lX,lY){var lX4,lY4,lX8,lY8,lResult;lX8=(lX&0x80000000);lY8=(lY&0x80000000);lX4=(lX&0x40000000);lY4=(lY&0x40000000);lResult=(lX&0x3FFFFFFF)+(lY&0x3FFFFFFF);if(lX4&lY4){return(lResult^0x80000000^lX8^lY8);}
if(lX4|lY4){if(lResult&0x40000000){return(lResult^0xC0000000^lX8^lY8);}else{return(lResult^0x40000000^lX8^lY8);}}else{return(lResult^lX8^lY8);}}
function F(x,y,z){return(x&y)|((~x)&z);}
function G(x,y,z){return(x&z)|(y&(~z));}
function H(x,y,z){return(x^y^z);}
function I(x,y,z){return(y^(x|(~z)));}
function FF(a,b,c,d,x,s,ac){a=AddUnsigned(a,AddUnsigned(AddUnsigned(F(b,c,d),x),ac));return AddUnsigned(RotateLeft(a,s),b);};function GG(a,b,c,d,x,s,ac){a=AddUnsigned(a,AddUnsigned(AddUnsigned(G(b,c,d),x),ac));return AddUnsigned(RotateLeft(a,s),b);};function HH(a,b,c,d,x,s,ac){a=AddUnsigned(a,AddUnsigned(AddUnsigned(H(b,c,d),x),ac));return AddUnsigned(RotateLeft(a,s),b);};function II(a,b,c,d,x,s,ac){a=AddUnsigned(a,AddUnsigned(AddUnsigned(I(b,c,d),x),ac));return AddUnsigned(RotateLeft(a,s),b);};function ConvertToWordArray(string){var lWordCount;var lMessageLength=string.length;var lNumberOfWords_temp1=lMessageLength+8;var lNumberOfWords_temp2=(lNumberOfWords_temp1-(lNumberOfWords_temp1%64))/64;var lNumberOfWords=(lNumberOfWords_temp2+1)*16;var lWordArray=Array(lNumberOfWords-1);var lBytePosition=0;var lByteCount=0;while(lByteCount<lMessageLength){lWordCount=(lByteCount-(lByteCount%4))/4;lBytePosition=(lByteCount%4)*8;lWordArray[lWordCount]=(lWordArray[lWordCount]|(string.charCodeAt(lByteCount)<<lBytePosition));lByteCount++;}
lWordCount=(lByteCount-(lByteCount%4))/4;lBytePosition=(lByteCount%4)*8;lWordArray[lWordCount]=lWordArray[lWordCount]|(0x80<<lBytePosition);lWordArray[lNumberOfWords-2]=lMessageLength<<3;lWordArray[lNumberOfWords-1]=lMessageLength>>>29;return lWordArray;};function WordToHex(lValue){var WordToHexValue="",WordToHexValue_temp="",lByte,lCount;for(lCount=0;lCount<=3;lCount++){lByte=(lValue>>>(lCount*8))&255;WordToHexValue_temp="0"+lByte.toString(16);WordToHexValue=WordToHexValue+WordToHexValue_temp.substr(WordToHexValue_temp.length-2,2);}
return WordToHexValue;};function Utf8Encode(string){string=string.replace(/\r\n/g,"\n");var utftext="";for(var n=0;n<string.length;n++){var c=string.charCodeAt(n);if(c<128){utftext+=String.fromCharCode(c);}
else if((c>127)&&(c<2048)){utftext+=String.fromCharCode((c>>6)|192);utftext+=String.fromCharCode((c&63)|128);}
else{utftext+=String.fromCharCode((c>>12)|224);utftext+=String.fromCharCode(((c>>6)&63)|128);utftext+=String.fromCharCode((c&63)|128);}}
return utftext;};var x=Array();var k,AA,BB,CC,DD,a,b,c,d;var S11=7,S12=12,S13=17,S14=22;var S21=5,S22=9,S23=14,S24=20;var S31=4,S32=11,S33=16,S34=23;var S41=6,S42=10,S43=15,S44=21;string=Utf8Encode(string);x=ConvertToWordArray(string);a=0x67452301;b=0xEFCDAB89;c=0x98BADCFE;d=0x10325476;for(k=0;k<x.length;k+=16){AA=a;BB=b;CC=c;DD=d;a=FF(a,b,c,d,x[k+0],S11,0xD76AA478);d=FF(d,a,b,c,x[k+1],S12,0xE8C7B756);c=FF(c,d,a,b,x[k+2],S13,0x242070DB);b=FF(b,c,d,a,x[k+3],S14,0xC1BDCEEE);a=FF(a,b,c,d,x[k+4],S11,0xF57C0FAF);d=FF(d,a,b,c,x[k+5],S12,0x4787C62A);c=FF(c,d,a,b,x[k+6],S13,0xA8304613);b=FF(b,c,d,a,x[k+7],S14,0xFD469501);a=FF(a,b,c,d,x[k+8],S11,0x698098D8);d=FF(d,a,b,c,x[k+9],S12,0x8B44F7AF);c=FF(c,d,a,b,x[k+10],S13,0xFFFF5BB1);b=FF(b,c,d,a,x[k+11],S14,0x895CD7BE);a=FF(a,b,c,d,x[k+12],S11,0x6B901122);d=FF(d,a,b,c,x[k+13],S12,0xFD987193);c=FF(c,d,a,b,x[k+14],S13,0xA679438E);b=FF(b,c,d,a,x[k+15],S14,0x49B40821);a=GG(a,b,c,d,x[k+1],S21,0xF61E2562);d=GG(d,a,b,c,x[k+6],S22,0xC040B340);c=GG(c,d,a,b,x[k+11],S23,0x265E5A51);b=GG(b,c,d,a,x[k+0],S24,0xE9B6C7AA);a=GG(a,b,c,d,x[k+5],S21,0xD62F105D);d=GG(d,a,b,c,x[k+10],S22,0x2441453);c=GG(c,d,a,b,x[k+15],S23,0xD8A1E681);b=GG(b,c,d,a,x[k+4],S24,0xE7D3FBC8);a=GG(a,b,c,d,x[k+9],S21,0x21E1CDE6);d=GG(d,a,b,c,x[k+14],S22,0xC33707D6);c=GG(c,d,a,b,x[k+3],S23,0xF4D50D87);b=GG(b,c,d,a,x[k+8],S24,0x455A14ED);a=GG(a,b,c,d,x[k+13],S21,0xA9E3E905);d=GG(d,a,b,c,x[k+2],S22,0xFCEFA3F8);c=GG(c,d,a,b,x[k+7],S23,0x676F02D9);b=GG(b,c,d,a,x[k+12],S24,0x8D2A4C8A);a=HH(a,b,c,d,x[k+5],S31,0xFFFA3942);d=HH(d,a,b,c,x[k+8],S32,0x8771F681);c=HH(c,d,a,b,x[k+11],S33,0x6D9D6122);b=HH(b,c,d,a,x[k+14],S34,0xFDE5380C);a=HH(a,b,c,d,x[k+1],S31,0xA4BEEA44);d=HH(d,a,b,c,x[k+4],S32,0x4BDECFA9);c=HH(c,d,a,b,x[k+7],S33,0xF6BB4B60);b=HH(b,c,d,a,x[k+10],S34,0xBEBFBC70);a=HH(a,b,c,d,x[k+13],S31,0x289B7EC6);d=HH(d,a,b,c,x[k+0],S32,0xEAA127FA);c=HH(c,d,a,b,x[k+3],S33,0xD4EF3085);b=HH(b,c,d,a,x[k+6],S34,0x4881D05);a=HH(a,b,c,d,x[k+9],S31,0xD9D4D039);d=HH(d,a,b,c,x[k+12],S32,0xE6DB99E5);c=HH(c,d,a,b,x[k+15],S33,0x1FA27CF8);b=HH(b,c,d,a,x[k+2],S34,0xC4AC5665);a=II(a,b,c,d,x[k+0],S41,0xF4292244);d=II(d,a,b,c,x[k+7],S42,0x432AFF97);c=II(c,d,a,b,x[k+14],S43,0xAB9423A7);b=II(b,c,d,a,x[k+5],S44,0xFC93A039);a=II(a,b,c,d,x[k+12],S41,0x655B59C3);d=II(d,a,b,c,x[k+3],S42,0x8F0CCC92);c=II(c,d,a,b,x[k+10],S43,0xFFEFF47D);b=II(b,c,d,a,x[k+1],S44,0x85845DD1);a=II(a,b,c,d,x[k+8],S41,0x6FA87E4F);d=II(d,a,b,c,x[k+15],S42,0xFE2CE6E0);c=II(c,d,a,b,x[k+6],S43,0xA3014314);b=II(b,c,d,a,x[k+13],S44,0x4E0811A1);a=II(a,b,c,d,x[k+4],S41,0xF7537E82);d=II(d,a,b,c,x[k+11],S42,0xBD3AF235);c=II(c,d,a,b,x[k+2],S43,0x2AD7D2BB);b=II(b,c,d,a,x[k+9],S44,0xEB86D391);a=AddUnsigned(a,AA);b=AddUnsigned(b,BB);c=AddUnsigned(c,CC);d=AddUnsigned(d,DD);}
var temp=WordToHex(a)+WordToHex(b)+WordToHex(c)+WordToHex(d);return temp.toLowerCase();}};
/* end of /whb/wp-content/themes/envision-parent/framework/static/javascript/tfuse-domnoready.js */
jQuery(document).ready(function($){$('.tfuse_selectable_code').live('click',function(){var r=document.createRange();var w=$(this).get(0);r.selectNodeContents(w);var sel=window.getSelection();sel.removeAllRanges();sel.addRange(r);});$(document).bind({reservationform_preview:function(){$('select.select_styled').selectmenu({style:'dropdown'});},contact_form_preview_open:function(){$('select.select_styled').selectmenu({style:'dropdown'});}});$('#tf_rf_form_name_select').change(function(){$_get=getUrlVars();if($(this).val()==-1&&'formid'in $_get){delete $_get.formid;}else if($(this).val()!=-1){$_get.formid=$(this).val();}
$_url_str='?';$.each($_get,function(key,val){$_url_str+=key+'='+val+'&';})
$_url_str=$_url_str.substring(0,$_url_str.length-1);window.location.href=$_url_str;});function getUrlVars(){urlParams={};var e,a=/\+/g,r=/([^&=]+)=?([^&]*)/g,d=function(s){return decodeURIComponent(s.replace(a," "));},q=window.location.search.substring(1);while(e=r.exec(q))
urlParams[d(e[1])]=d(e[2]);return urlParams;}
var options=new Array();options['envision_header_element']=jQuery('#envision_header_element').val();jQuery('#envision_header_element').bind('change',function(){options['envision_header_element']=jQuery(this).val();tfuse_toggle_options(options);});options['envision_header_welcome_template']=jQuery('#envision_header_welcome_template').val();jQuery('#envision_header_welcome_template').bind('change',function(){options['envision_header_welcome_template']=jQuery(this).val();tfuse_toggle_options(options);});options['envision_header_welcome_bar']=jQuery('#envision_header_welcome_bar').attr('checked')?1:0;options['envision_homepage_category']=jQuery('#envision_homepage_category').val();jQuery('#envision_homepage_category').bind('change',function(){options['envision_homepage_category']=jQuery(this).val();tfuse_toggle_options(options);});options['envision_header_element_blog']=jQuery('#envision_header_element_blog').val();jQuery('#envision_header_element_blog').bind('change',function(){options['envision_header_element_blog']=jQuery(this).val();tfuse_toggle_options(options);});options['envision_header_welcome_template_blog']=jQuery('#envision_header_welcome_template_blog').val();jQuery('#envision_header_welcome_template_blog').bind('change',function(){options['envision_header_welcome_template_blog']=jQuery(this).val();tfuse_toggle_options(options);});options['envision_blogpage_category']=jQuery('#envision_blogpage_category').val();jQuery('#envision_blogpage_category').bind('change',function(){options['envision_blogpage_category']=jQuery(this).val();tfuse_toggle_options(options);});options['envision_header_welcome_bar_blog']=jQuery('#envision_header_welcome_bar_blog').attr('checked')?1:0;tfuse_toggle_options(options);jQuery('#envision_header_welcome_bar').bind('change',function(){options['envision_header_welcome_bar']=jQuery('#envision_header_welcome_bar').attr('checked')?1:0;tfuse_toggle_options(options);});jQuery('#envision_header_welcome_bar_blog').bind('change',function(){options['envision_header_welcome_bar_blog']=jQuery('#envision_header_welcome_bar_blog').attr('checked')?1:0;tfuse_toggle_options(options);});function tfuse_toggle_options(options)
{jQuery('#envision_portfolio_select_categ_blog,#envision_template_portfolio_blog,#envision_portfolio_select_categ,#envision_template_portfolio,#envision_select_slider, #envision_header_image, #envision_header_image_link, #envision_header_image_target, '+' #envision_header_welcome_template, #envision_header_your_template, #envision_header_welcome_title, #envision_header_welcome_subtitle,'+' #envision_header_welcome_icon, #envision_header_our_template, #slider_type').parents('.option-inner').hide();jQuery('#envision_portfolio_select_categ_blog,#envision_template_portfolio_blog,#envision_portfolio_select_categ,#envision_template_portfolio,#envision_select_slider, #envision_header_image, #envision_header_image_link, #envision_header_image_target, '+' #envision_header_welcome_template, #envision_header_your_template, #envision_header_welcome_title, #envision_header_welcome_subtitle,'+' #envision_header_welcome_icon, #envision_header_our_template, #slider_type').parents('.form-field').hide();if(options['envision_header_element']=='slider')
{jQuery('#envision_select_slider').parents('.option-inner').show();jQuery('#envision_select_slider').parents('.form-field').show();}
else if(options['envision_header_element']=='image')
{jQuery('#envision_header_image, #envision_header_image_link, #envision_header_image_target').parents('.option-inner').show();jQuery('#envision_header_image, #envision_header_image_link, #envision_header_image_target').parents('.form-field').show();}
if(options['envision_header_welcome_bar']){jQuery('#envision_header_welcome_template').parents('.option-inner').show();jQuery('#envision_header_welcome_template').parents('.form-field').show();if(options['envision_header_welcome_template']=='your'){jQuery('#envision_header_your_template').parents('.option-inner').show();jQuery('#envision_header_your_template').parents('.form-field').show();}
else{jQuery('#envision_header_welcome_title, #envision_header_welcome_subtitle, #envision_header_welcome_icon, #envision_header_our_template').parents('.option-inner').show();jQuery('#envision_header_welcome_title, #envision_header_welcome_subtitle, #envision_header_welcome_icon, #envision_header_our_template').parents('.form-field').show();}}
if(options['envision_homepage_category']=='all'){jQuery('.envision_use_page_options,.envision_categories_select_categ,.envision_home_page').hide();jQuery('#homepage-slider,#homepage-header').show();}
else if(options['envision_homepage_category']=='specific'){jQuery('#homepage-slider,#homepage-header,.envision_categories_select_categ').show();jQuery('.envision_use_page_options,.envision_home_page').hide();}
else if(options['envision_homepage_category']=='all_tax'){jQuery('#envision_template_portfolio').parents('.option-inner').show();jQuery('#envision_template_portfolio').parents('.form-field').show();jQuery('.envision_use_page_options,.envision_home_page').hide();jQuery('.envision_categories_select_categ').hide();}
else if(options['envision_homepage_category']=='specific_tax'){jQuery('#envision_template_portfolio,#envision_portfolio_select_categ').parents('.option-inner').show();jQuery('#envision_template_portfolio,#envision_portfolio_select_categ').parents('.form-field').show();jQuery('.envision_use_page_options,.envision_home_page').hide();jQuery('.envision_categories_select_categ').hide();}
else if(options['envision_homepage_category']=='page'){jQuery('.envision_use_page_options,.envision_home_page').show();jQuery('.envision_categories_select_categ').hide();if($('#envision_use_page_options').is(':checked'))jQuery('#homepage-slider,#homepage-header').hide();jQuery('#envision_use_page_options').live('change',function(){if(jQuery(this).is(':checked'))
jQuery('#homepage-slider,#homepage-header').hide();else
jQuery('#homepage-slider,#homepage-header').show();});}
if(options['envision_header_element_blog']=='slider')
{jQuery('.envision_header_image_blog,.envision_header_image_link_blog,.envision_header_image_target_blog').hide();jQuery('.envision_select_slider_blog').show();}
else if(options['envision_header_element_blog']=='image')
{jQuery('.envision_header_image_blog,.envision_header_image_link_blog,.envision_header_image_target_blog').show();jQuery('.envision_select_slider_blog').hide();}
if(options['envision_header_welcome_bar_blog']){jQuery('.envision_header_welcome_title_blog,.envision_header_welcome_subtitle_blog,.envision_header_welcome_icon_blog,.envision_header_our_template_blog,.envision_header_your_template_blog,.envision_header_welcome_template_blog').show();if(options['envision_header_welcome_template_blog']=='our'){jQuery('.envision_header_welcome_title_blog,.envision_header_welcome_subtitle_blog,.envision_header_welcome_icon_blog,.envision_header_our_template_blog').show();jQuery('.envision_header_your_template_blog').hide();}
else{jQuery('.envision_header_your_template_blog').show();jQuery('.envision_header_welcome_title_blog,.envision_header_welcome_subtitle_blog,.envision_header_welcome_icon_blog,.envision_header_our_template_blog').hide();}}
else{jQuery('.envision_header_welcome_title_blog,.envision_header_welcome_subtitle_blog,.envision_header_welcome_icon_blog,.envision_header_our_template_blog,.envision_header_your_template_blog,.envision_header_welcome_template_blog').hide();}
if(options['envision_blogpage_category']=='all')
jQuery('.envision_categories_select_categ_blog').hide();else if(options['envision_blogpage_category']=='all_tax')
{jQuery('#envision_template_portfolio_blog').parents('.option-inner').show();jQuery('#envision_template_portfolio_blog').parents('.form-field').show();jQuery('.envision_categories_select_categ_blog').hide();}
else if(options['envision_blogpage_category']=='specific_tax')
{jQuery('#envision_template_portfolio_blog').parents('.option-inner').show();jQuery('#envision_template_portfolio_blog').parents('.form-field').show();jQuery('#envision_portfolio_select_categ_blog').parents('.option-inner').show();jQuery('#envision_portfolio_select_categ_blog').parents('.form-field').show();jQuery('.envision_categories_select_categ_blog').hide();}
else
jQuery('.envision_categories_select_categ_blog').show();}});
/* end of /whb/wp-content/themes/envision-parent/js/advanced.js */
jQuery(document).ready(function($){var $newsletter_service=$('#'+tf_script.TF_THEME_PREFIX+'_newsletter_service');$('.'+$newsletter_service.val()+'_apikey').show();$newsletter_service.change(function(){$('.newsletter_apikey_holder').hide();$('.'+$(this).val()+'_apikey').show();});$('#tfuse_newsletter_save_api_key').click(function(){var api_key_input=$('#tfuse_'+$newsletter_service.val()+'_api_key');var api_key=api_key_input.val();var service=$('#'+tf_script.TF_THEME_PREFIX+'_newsletter_service').val();if(!api_key&&service!='none'){alert('You must provide your '+$newsletter_service.val()+' API key!');return;}
$.post(ajaxurl,{action:'tfuse_ajax_newsletter',tf_action:'tfuse_ajax_newsletter_save_api_key',api_key:api_key,service:service},function(data){if(data.status==-1){alert(data.message);api_key_input.val('');}
if(data.status==1)
window.location.reload();},'json');});$('#tfuse_newsletter_save_list').click(function(){var list_obj=$('#tfuse_'+tf_script.newsletter_service+'_list');var list_id=list_obj.val();if(!list_id){alert('You must select a list!');return;}
$.post(ajaxurl,{action:'tfuse_ajax_newsletter',tf_action:'tfuse_ajax_newsletter_save_'+tf_script.newsletter_service+'_list',list_id:list_id},function(data){if(data.status==-1){alert(data.message);}
else if(data.status==1)
window.location.reload();},'json');});$('#tfuse_newsletter_save_client').click(function(){var client_obj=$('#tfuse_campaignmonitor_client');var client_id=client_obj.val();if(!client_id){alert('You must select a client!');return;}
$.post(ajaxurl,{action:'tfuse_ajax_newsletter',tf_action:'tfuse_ajax_newsletter_save_campaignmonitor_client',client_id:client_id},function(data){if(data.status==-1){alert(data.message);}
else if(data.status==1)
window.location.reload();},'json');});$('#tfuse_newsletter_fetch_emails_subscribed').click(function(){$.post(ajaxurl,{action:'tfuse_ajax_newsletter',tf_action:'tfuse_ajax_newsletter_fetch_emails_subscribed_'+tf_script.newsletter_service},function(data){if(data.status==-1){alert(data.message);}
else if(data.status==1){$('#output_field').val(data.emails);$('#tfuse_newsletter_total_emails').show().find('span').html(data.count);}},'json');});});
/* end of /whb/wp-content/themes/envision-parent/framework/extensions/newsletter/static/js/newsletter.js */
var current_shortcode_editor;var tf_shc_global_clipboard='';jQuery(function($){if(window.QTags){QTags.addButton('tf_qtag_add_shortcode','add shortcode','');$('#qt_content_tf_qtag_add_shortcode, #qt_qtrans_textarea_content_tf_qtag_add_shortcode').click(function(){current_shortcode_editor='html';$('#content').data('selectionStart',$('#content')[0].selectionStart);$('#content').data('selectionEnd',$('#content')[0].selectionEnd);selectedText=get_editor_selection($('#content')[0]);tf_shortcode_dialog(selectedText);});$('body').on('click','.tf_shortcode_element',function(){var shc_type=$(this).attr('rel');$('#tf_shortcode_list').hide();$('#tf_shortcode_options').show().find('.tf_shortcode_option').hide().andSelf().find('.tf_shortcode_option[rel="'+shc_type+'"]').show();$('#tf_shortcode_controls').find('#tf_shortcode_control_buttons').show().andSelf().find('#tf_shortcode_control_filters').hide();$option_box=$('.tf_shortcode_option:visible','#tf_shortcode_options');height=$option_box.parents('#tf_shortcode_options').height()-74;$option_box.height(height);if($option_box.prop('has_scrollbar')!==true)
$option_box.prop('has_scrollbar',true).lionbars();if($(this).find('.instant_shc').length>0){$('#tf_shortcode_insert').click();}
if(tf_shc_global_clipboard)
$('[name^="tf_shc_"]').filter('[name$="_content"]').val(tf_shc_global_clipboard);start_auto_preview(true);});$('body').on('click','#tf_shortcode_insert',function(){sh_type=$('.tf_shortcode_option:visible').attr('rel');sh_options=tf_shc_obtain_options(sh_type);if(current_shortcode_editor=='tinymce')
tinyMCE.activeEditor.execCommand("mceInsertContent",false,generate_shortcode(sh_type,sh_options));else{$('#content').selectRange($('#content').data('selectionStart'),$('#content').data('selectionEnd'));QTags.insertContent(generate_shortcode(sh_type,sh_options));}
start_auto_preview(false);tb_remove();return false;});$('body').on('click','#tf_shortcode_back',function(){$('#tf_shortcode_controls').find('#tf_shortcode_control_buttons').hide().andSelf().find('#tf_shortcode_control_filters').show();$('#tf_shortcode_list').show();$('#tf_shortcode_options').hide();start_auto_preview(false);return false;});$('body').on('mouseover mouseout','.tf_shortcode_preview_div',function(event){if(event.type=='mouseout'){preview_normal();}
if(event.type=='mouseover'){preview_large();}});$('body').on('change','#tf_shortcode_categories',function(){var cat_id=$(this).val();$('.tf_shortcode_element').show();if(cat_id=='all'){return;}
$('.tf_shortcode_element').each(function(){if($(this).attr('category')!=cat_id)
$(this).hide();});});$('body').on('keyup','#tf_shortcode_text_filter',function(){var search=$(this).val();$('.tf_shortcode_element').show();$('.tf_shortcode_element').each(function(){if(stripos($(this).find('h3').html(),search)===false&&stripos($(this).find('.description').html(),search)===false)
$(this).hide();});});$('body').on('click','.tf_shc_addable_add',function(){var obj=$('.tf_shc_addable').filter(':visible').first().parents('.option');var last_one=$('.tf_shc_addable_last').filter(':visible').last().parents('.option');var container=last_one.parents('.tf_shortcode_option');var id=uniqid();k=true;i=0;while(k){if(last_one.next('.divider').length>0)
last_one.next('.divider').after(obj.clone());else
last_one.after(obj.clone());last_one=last_one.nextAll('.option').eq(0);if(last_one.find('.tf_shc_addable_last').length>0){last_one.after($('.divider:first:visible').clone());k=false;}
last_one.addClass('tf_shc_addable_uniqid_'+id).removeClass('tf_shc_addable_uniqid_a').prop('uniqid',id);opt_reset(last_one.attr('option'),last_one);i++;obj=$('.tf_shc_addable_'+i).filter(':visible').first().parents('.option');if(i>2000){k=false;}}
container.lionbars_reload();container.find('.lb-wrap').scrollTop(container.find('.lb-content').height());});$('body').on('click','.tf_shc_addable_remove',function(){container=$(this).parents('.tf_shortcode_option');container.find('.tf_shc_addable_uniqid_'+$(this).parents('.option').prop('uniqid')).next('.divider').remove().andSelf().remove();container.lionbars_reload();});}});function tf_shc_obtain_options(sh_type){sh_options={};pattern=new RegExp('^tf_shc_'+sh_type+'_','ig');if(sh_type!=undefined)
for(i in tf_script.shc_ids[sh_type]){sh_options[tf_script.shc_ids[sh_type][i].replace(pattern,'')]=opt_get(tf_script.shc_ids[sh_type][i]);}
if(typeof window['custom_obtainer_'+sh_type]=='function'){return window['custom_obtainer_'+sh_type](sh_options);}
return sh_options;}
function generate_shortcode(type,options){shortcode='['+type;for(i in options){if(i=='content')
continue;shortcode+=' '+i+'="'+options[i]+'"';}
shortcode+=']';if(options['content']!=undefined){shortcode+=options['content']+"[/"+type+']';}
if(typeof window['custom_generator_'+type]=='function'){return window['custom_generator_'+type](type,options);}
return shortcode;}
function add_addables(){var $=jQuery;if($('.tf_shc_addable_0').length>0){$('.tf_shc_addable').parents('.option').addClass('tf_shc_addable_uniqid_a');obj=$('.tf_shc_addable_0').parents('.option').nextAll('.option').find('.tf_shc_addable_last:first').parents('.formcontainer');if(obj.find('.addable_controls').length==0){obj.parents('.option').prop('uniqid','a');obj.append('<div class="addable_controls"><span class="tf_shc_addable_add">Add</span> <span class="tf_shc_addable_remove">Remove</span>');}}}
function tf_shortcode_dialog(selection){tf_shc_global_clipboard=selection;var $=jQuery;if($('#tfuse_shortcode_dialog').length<1)
$('body').append('<div id="tfuse_shortcode_dialog"></div>');$('#tfuse_shortcode_dialog').html('');$.post(ajaxurl,{action:'tfuse_ajax_shortcodes',tf_action:'tfuse_ajax_add_shortcode_page',post_id:$('#post_ID').val()},function(data){if(data.content!=undefined){var w=$(window).width();var h=$(window).height();w=720<w?720:w;w-=80;h-=84;$('#tfuse_shortcode_dialog').html(data.content).hide();tb_show("Insert Shortcode","#TB_inline?width="+w+"&height="+h+"&inlineId=tfuse_shortcode_dialog");curr_height=$('#TB_ajaxContent').height()-20;$('.tfuse_shortcode_page').height(curr_height);curr_height=$('.tfuse_shortcode_page').height()-50;$('#tf_shortcode_options').height(curr_height);$('#tf_shortcode_list').height(curr_height-30).lionbars();tf_optionize();add_addables();}
if(data.shc_ids!=undefined){tf_script.shc_ids=data.shc_ids;}},'json');}
function preview_large(){var $=jQuery;$('#tf_shortcode_preview_iframe').stop().animate({'width':'638px','height':'300px'},200);}
function preview_normal(){var $=jQuery;$('#tf_shortcode_preview_iframe').stop().animate({'width':'100%','height':'100%'},200);}
function get_editor_selection(id){start=id.selectionStart;end=id.selectionEnd;val=id.value;ret=val.substr(start,(end-start));createSelection(start,end,id);return ret;}
function createSelection(start,end,field){if(field.createTextRange){var newend=end-start;var selRange=field.createTextRange();selRange.collapse(true);selRange.moveStart("character",start);selRange.moveEnd("character",newend);selRange.select();}
else if(field.setSelectionRange){field.setSelectionRange(start,end);}}
function start_auto_preview(clear){var $=jQuery;if(clear===false){if(typeof this.timer!='undefined'){clearTimeout(this.timer);this.doing_iframe=false;this.timer=null;$('#tf_shortcode_preview_iframe').attr('src','');return;}}
if(clear===10)
this.doing_iframe=false;if(this.doing_iframe===true)
return;this.timer=setTimeout(function(){if($('.tfuse_shortcode_page').filter(':visible').length==0){start_auto_preview(false);return;}
sh_type=$('.tf_shortcode_option:visible').attr('rel');sh_options=tf_shc_obtain_options(sh_type);if(this.sh_data&&this.sh_data['type']==sh_type){skip=true;if(JSON.stringify(sh_options)!=JSON.stringify(this.sh_data['options']))
{skip=false;}
if(skip===true){start_auto_preview(true);return;}}
this.sh_data={};this.sh_data['options']=sh_options;this.sh_data['type']=sh_type;this.doing_iframe=true;$('#tf_shc_form_value').val(generate_shortcode(sh_type,sh_options));$('#tf_shc_form_type').val(sh_type);$('#tf_shortcode_preview_iframe').attr('src','');$('#tf_shc_form').submit();start_auto_preview(true);},this.timer?3000:10);}
/* end of /whb/wp-content/themes/envision-parent/framework/extensions/shortcodes/static/js/shortcodes.js */
function custom_generator_faq(type,options){shortcode='[faq title="'+options.title+'"]';for(i in options.array){shortcode+='[faq_question]'+options.array[i]['question']+'[/faq_question]';shortcode+='[faq_answer]'+options.array[i]['answer']+'[/faq_answer]';}
shortcode+='[/faq]';return shortcode;}
function custom_obtainer_faq(data){cont=jQuery('.tf_shortcode_option:visible');sh_options={};sh_options['array']=[];sh_options['title']=opt_get('tf_shc_faq_title',cont);cont.find('[name="tf_shc_faq_question"]').each(function(i){question=jQuery(this).val();answer=jQuery(this).parents('.option').nextAll('.option').find('[name="tf_shc_faq_answer"]:first').val();tmp={};tmp['question']=question;tmp['answer']=answer;sh_options['array'].push(tmp);})
return sh_options;}
function custom_generator_tabs(type,options){shortcode='[tabs class="'+options['class']+'"]';for(i in options.array){shortcode+='[tab title="'+options.array[i]['title']+'"]'+options.array[i]['content']+'[/tab]';}
shortcode+='[/tabs]';return shortcode;}
function custom_obtainer_tabs(data){cont=jQuery('.tf_shortcode_option:visible');sh_options={};sh_options['array']=[];sh_options['class']=opt_get('tf_shc_tabs_class',cont);cont.find('[name="tf_shc_tabs_title"]').each(function(i){div=jQuery(this).parents('.option');title=opt_get(jQuery(this).attr('name'),div);div=jQuery(this).parents('.option').nextAll('.option').find('[name="tf_shc_tabs_content"]').first().parents('.option');content=opt_get(jQuery(this).parents('.option').nextAll('.option').find('[name="tf_shc_tabs_content"]').first().attr('name'),div);tmp={};tmp['title']=title;tmp['content']=content;sh_options['array'].push(tmp);})
console.log(sh_options)
return sh_options;}
function custom_generator_icon_tabs(type,options){shortcode='[icon_tabs class="'+options['class']+'" title="'+options['title']+'" width="'+options['width']+'" height="'+options['height']+'"]';for(i in options.array){shortcode+='[icon_tab icon="'+options.array[i]['icon']+'"]'+options.array[i]['content']+'[/icon_tab]';}
shortcode+='[/icon_tabs]';return shortcode;}
function custom_obtainer_icon_tabs(data){var jQuery=jQuery;cont=jQuery('.tf_shortcode_option:visible');sh_options={};sh_options['array']=[];sh_options['title']=opt_get('tf_shc_icon_tabs_title',cont);sh_options['class']=opt_get('tf_shc_icon_tabs_class',cont);sh_options['width']=opt_get('tf_shc_icon_tabs_width',cont);sh_options['height']=opt_get('tf_shc_icon_tabs_height',cont);cont.find('[name="tf_shc_icon_tabs_icon"]').each(function(i){div=jQuery(this).parents('.option');icon=opt_get(jQuery(this).attr('name'),div);div=jQuery(this).parents('.option').nextAll('.option').find('[name="tf_shc_icon_tabs_content"]').first().parents('.option');content=opt_get(jQuery(this).parents('.option').nextAll('.option').find('[name="tf_shc_icon_tabs_content"]').first().attr('name'),div);tmp={};tmp['icon']=icon;tmp['content']=content;sh_options['array'].push(tmp);})
console.log(sh_options)
return sh_options;}
/* end of /whb/wp-content/themes/envision-parent/theme_config/extensions/shortcodes/static/js/shortcodes_custom_generators.js */
(function($){$.fn.hasScrollBar=function(){return this.get(0).scrollHeight>this.height();};$.fn.lionbars_reload=function(){$(this).find('.lb-v-scrollbar').remove();height=$(this).height();width=$(this).width();$(this).removeAttr('style').removeAttr('vratio').removeAttr('hratio');$(this).height(height).width(width);$(this).find('.lb-content').children().eq(0).unwrap();$(this).find('.lb-wrap').children().eq(0).unwrap();$(this).lionbars();};$.fn.lionbars=function(options){options=options||{};autohide=options.autohide;var timeout,HDragging=false,VDragging=false,activeScroll=0,activeWrap=0,eventX,eventY,mouseX,mouseY,currentRatio,initPos,scrollValue,hideTimeoutSet=false,vEventFired=false,hEventFired=false;var elements=$(this),id=0,vScrollWidth=0,hScrollWidth=0,addHScroll=false,addVScroll=false,paddingTop=0,paddingLeft=0,paddingBottom=0,paddingRight=0,borderTop=0,borderRight=0,borderBottom=0,borderLeft=0,scrollHeight=0,scrollWidth=0,offsetWidth=0,offsetHeight=0,clientWidth=0,clientHeight=0,vRatio=0,hRatio=0,vSliderHeight=0,hSliderHeight=0,vLbHeight=0,hLbHeight=0;mainLoop();function mainLoop(){for(var i=0;elements[i]!==undefined;i++){if(needScrollbars(elements[i])&&!$(elements[i]).hasClass('nolionbars')){target=elements[i];getDimentions(target);wrap(target,addVScroll,addHScroll);hideScrollbars(target,addVScroll,addHScroll);reduceScrollbarsWidthHeight(target);setSlidersHeight(target);setScrollRatios(target);setEvents(target);resetVars();}}}
$(document).mousemove(function(e){if(VDragging){mouseY=e.pageY;activeWrap.scrollTop((initPos+mouseY-eventY)*Math.abs(currentRatio));}
if(HDragging){mouseX=e.pageX;activeWrap.scrollLeft((initPos+mouseX-eventX)*Math.abs(currentRatio));}});$(document).mouseup(function(e){if(VDragging){VDragging=false;}
if(HDragging){HDragging=false;}});function setEvents(elem){var el=$(elem);if(addVScroll||addHScroll){el.find('.lb-wrap').scroll(function(e){el.find('.lb-v-scrollbar-slider').css({"top":-$(this).scrollTop()/el.attr('vratio')});el.find('.lb-h-scrollbar-slider').css({"left":-$(this).scrollLeft()/el.attr('hratio')});if(el.find('.lb-v-scrollbar').height()==(parseInt(el.find('.lb-v-scrollbar-slider').css('top'))+el.find('.lb-v-scrollbar-slider').height())&&typeof(options.reachedBottom)=='function'&&!vEventFired){vEventFired=true;var self=$(this);options.reachedBottom.apply($(this).children('.lb-content'),[function(){getDimentions($(self).parent(),{height:$(self).children('.lb-content').get(0).scrollHeight,width:$(self).children('.lb-content').get(0).scrollWidth});reduceScrollbarsWidthHeight($(self).parent());setSlidersHeight($(self).parent());setScrollRatios($(self).parent());resetVars();vEventFired=false;}]);}
if(el.find('.lb-h-scrollbar').width()==(parseInt(el.find('.lb-h-scrollbar-slider').css('left'))+el.find('.lb-h-scrollbar-slider').width())&&typeof(options.reachedRight)=='function'&&!hEventFired){hEventFired=true;var self=$(this);options.reachedRight.apply($(this).children('.lb-content'),[function(){getDimentions($(self).parent(),{height:$(self).children('.lb-content').get(0).scrollHeight,width:$(self).children('.lb-content').get(0).scrollWidth});reduceScrollbarsWidthHeight($(self).parent());setSlidersHeight($(self).parent());setScrollRatios($(self).parent());resetVars();hEventFired=false;}]);}
if(autohide){el.find('.lb-v-scrollbar, .lb-h-scrollbar').fadeIn(150);clearTimeout(timeout);timeout=setTimeout(function(){el.find('.lb-v-scrollbar, .lb-h-scrollbar').fadeOut(150);},2000);}});}
if(addVScroll){el.find('.lb-v-scrollbar-slider').mousedown(function(e){eventY=e.pageY;VDragging=true;activeScroll=$(this);activeWrap=el.find('.lb-wrap');currentRatio=activeWrap.parent().attr('vratio');initPos=activeScroll.position().top;return false;});el.find('.lb-v-scrollbar').mousedown(function(e){if(!$(e.target).hasClass('lb-v-scrollbar-slider')){el.find('.lb-wrap').scrollTop((e.pageY-$(this).offset().top)*Math.abs(el.attr('vratio'))-$(this).find('.lb-v-scrollbar-slider').height()/2);}
return false;});}
if(addHScroll){el.find('.lb-h-scrollbar-slider').mousedown(function(e){eventX=e.pageX;HDragging=true;activeScroll=$(this);activeWrap=el.find('.lb-wrap');currentRatio=activeWrap.parent().attr('hratio');initPos=activeScroll.position().left;return false;});el.find('.lb-h-scrollbar').mousedown(function(e){if(!$(e.target).hasClass('lb-h-scrollbar-slider')){el.find('.lb-wrap').scrollLeft((e.pageX-$(this).offset().left)*Math.abs(el.attr('hratio'))-$(this).find('.lb-h-scrollbar-slider').width()/2);}
return false;});}
if((addVScroll||addHScroll)&&autohide){el.find('.lb-v-scrollbar, .lb-h-scrollbar').hide();el.hover(function(){},function(){el.find('.lb-v-scrollbar, .lb-h-scrollbar').fadeOut(150);});}}
function setScrollRatios(elem){vRatio=(offsetHeight-$(elem).find('.lb-wrap').get(0).scrollHeight-borderTop-borderBottom)/(vLbHeight-vSliderHeight);hRatio=(offsetWidth-$(elem).find('.lb-wrap').get(0).scrollWidth-borderLeft-borderRight)/(hLbHeight-hSliderHeight);var el=$(elem);el.attr('vratio',vRatio);el.attr('hratio',hRatio);}
function setSlidersHeight(elem){var el=$(elem);var hmin,hmax,gap;if(el.find('.lb-v-scrollbar').length!=0){hmin=20;gap=offsetHeight-el.find('.lb-v-scrollbar').height();hmax=offsetHeight-gap-hmin;vSliderHeight=Math.round((offsetHeight*hmax)/scrollHeight);vSliderHeight=(vSliderHeight<hmin)?hmin:vSliderHeight;}
if(el.find('.lb-h-scrollbar').length!=0){hmin=20;gap=offsetWidth-el.find('.lb-h-scrollbar').width();hmax=offsetWidth-gap-hmin;hSliderHeight=Math.round((offsetWidth*hmax)/scrollWidth);hSliderHeight=(hSliderHeight<hmin)?hmin:hSliderHeight;}
el.find('.lb-v-scrollbar-slider').css({"height":vSliderHeight});el.find('.lb-h-scrollbar-slider').css({"width":hSliderHeight});}
function resetVars(){vScrollWidth=0;hScrollWidth=0;addHScroll=false;addVScroll=false;paddingTop=0;paddingLeft=0;paddingBottom=0;paddingRight=0;borderTop=0;borderLeft=0;borderBottom=0;borderRight=0;scrollHeight=0;scrollWidth=0;offsetWidth=0;offsetHeight=0;clientWidth=0;clientHeight=0;vSliderHeight=0;hSliderHeight=0;vLbHeight=0;hLbHeight=0;}
function reduceScrollbarsWidthHeight(elem){var el=$(elem);if(addVScroll&&addHScroll){vLbHeight=el.height()-12;hLbHeight=el.width()-12;el.find('.lb-v-scrollbar').css({"height":vLbHeight});el.find('.lb-h-scrollbar').css({"width":hLbHeight});}else{vLbHeight=el.height()-4;hLbHeight=el.width()-4;el.find('.lb-v-scrollbar').css({"height":vLbHeight});el.find('.lb-h-scrollbar').css({"width":hLbHeight});}}
function hideScrollbars(elem,vscroll,hscroll){var el=$(elem);if(vscroll||hscroll){el.css({"overflow":'hidden'});movePadding(el,el.find('.lb-wrap'));resizeMainBox(el);resizeInnerWrap(el,el.find('.lb-wrap'));}}
function resizeMainBox(elem){var el=$(elem);el.css({"width":el.width()+paddingLeft+paddingRight,"height":el.height()+paddingTop+paddingBottom});}
function movePadding(from,to){var fromEl=$(from);var toEl=$(to);fromEl.css({"padding":0});toEl.css({"padding-top":paddingTop+'px',"padding-left":paddingLeft+'px',"padding-bottom":paddingBottom+'px',"padding-right":paddingRight+'px'});}
function resizeInnerWrap(main,child){var mainEl=$(main);var childEl=$(child);mainEl.css({"position":'relative'});childEl.css({"width":mainEl.width()+vScrollWidth-paddingLeft-paddingRight,"height":mainEl.height()+hScrollWidth-paddingTop-paddingBottom});}
function setVScrollbarWidth(elem){var el=$(elem);el.css({"overflow":'auto'});vScrollWidth=offsetWidth-clientWidth-borderLeft-borderRight;el.css({"overflow":'hidden'});}
function setHScrollbarWidth(elem){var el=$(elem);el.css({"overflow":'auto'});hScrollWidth=offsetHeight-clientHeight-borderTop-borderBottom;el.css({"overflow":'hidden'});}
function wrap(elem,vscroll,hscroll){var el=$(elem);var elemId=el.attr('id');var wrap=0;if(elemId!==undefined){el.wrapInner('<div class="lb-wrap" id="lb-wrap-'+id+'-'+elemId+'"></div>');wrap=$('#lb-wrap-'+id+'-'+elemId);}else{el.wrapInner('<div class="lb-wrap" id="lb-wrap-'+id+'"></div>');wrap=$('#lb-wrap-'+id);}
wrap.wrapInner('<div class="lb-content"></div>');if(vscroll){el.prepend('<div class="lb-v-scrollbar"></div>');el.find('.lb-v-scrollbar').append('<div class="lb-v-scrollbar-slider"></div>');}
if(hscroll){el.prepend('<div class="lb-h-scrollbar"></div>');el.find('.lb-h-scrollbar').append('<div class="lb-h-scrollbar-slider"></div>');}
id=id+1;}
function needScrollbars(elem){var el=$(elem);addVScroll=false;addHScroll=false;getPadding(el);getBorders(el);el.css({"overflow":'hidden'});if(el.get(0).scrollHeight>el.get(0).clientHeight){addVScroll=true;}
if(el.get(0).scrollWidth>el.get(0).clientWidth){addHScroll=true;}
el.css({"overflow":'auto'});if(addVScroll||addHScroll){return true;}}
function getPadding(elem){var el=$(elem);paddingTop=parseInt(el.css('padding-top').replace('px',''));paddingLeft=parseInt(el.css('padding-left').replace('px',''));paddingBottom=parseInt(el.css('padding-bottom').replace('px',''));paddingRight=parseInt(el.css('padding-right').replace('px',''));}
function getBorders(elem){var el=$(elem);borderTop=parseInt(el.css('border-top-width').replace('px',''));borderRight=parseInt(el.css('border-right-width').replace('px',''));borderBottom=parseInt(el.css('border-bottom-width').replace('px',''));borderLeft=parseInt(el.css('border-left-width').replace('px',''));}
function getDimentions(elem,scroll){var el=$(elem).get(0);scrollHeight=(typeof(scroll)!='undefined')?scroll.height:el.scrollHeight;scrollWidth=(typeof(scroll)!='undefined')?scroll.width:el.scrollWidth;clientHeight=el.clientHeight;clientWidth=el.clientWidth;offsetHeight=el.offsetHeight;offsetWidth=el.offsetWidth;setVScrollbarWidth($(elem));setHScrollbarWidth($(elem));}
return this.each(function(){});};})(jQuery);
/* end of /whb/wp-content/themes/envision-parent/framework/static/javascript/jquery.lionbars.0.3.js */
(function($){$.prettyPhoto={version:'3.1.4'};$.fn.prettyPhoto=function(pp_settings){pp_settings=jQuery.extend({hook:'rel',animation_speed:'fast',ajaxcallback:function(){},slideshow:5000,autoplay_slideshow:false,opacity:0.80,show_title:true,allow_resize:true,allow_expand:true,default_width:500,default_height:344,counter_separator_label:'/',theme:'pp_default',horizontal_padding:20,hideflash:false,wmode:'opaque',autoplay:true,modal:false,deeplinking:false,overlay_gallery:true,overlay_gallery_max:30,keyboard_shortcuts:true,changepicturecallback:function(){},callback:function(){},ie6_fallback:true,markup:'<div class="pp_pic_holder"> \
      <div class="ppt">&nbsp;</div> \
      <div class="pp_top"> \
       <div class="pp_left"></div> \
       <div class="pp_middle"></div> \
       <div class="pp_right"></div> \
      </div> \
      <div class="pp_content_container"> \
       <div class="pp_left"> \
       <div class="pp_right"> \
        <div class="pp_content"> \
         <div class="pp_loaderIcon"></div> \
         <div class="pp_fade"> \
          <a href="#" class="pp_expand" title="Expand the image">Expand</a> \
          <div class="pp_hoverContainer"> \
           <a class="pp_next" href="#">next</a> \
           <a class="pp_previous" href="#">previous</a> \
          </div> \
          <div id="pp_full_res"></div> \
          <div class="pp_details"> \
           <div class="pp_nav"> \
            <a href="#" class="pp_arrow_previous">Previous</a> \
            <p class="currentTextHolder">0/0</p> \
            <a href="#" class="pp_arrow_next">Next</a> \
           </div> \
           <p class="pp_description"></p> \
           <div class="pp_social">{pp_social}</div> \
           <a class="pp_close" href="#">Close</a> \
          </div> \
         </div> \
        </div> \
       </div> \
       </div> \
      </div> \
      <div class="pp_bottom"> \
       <div class="pp_left"></div> \
       <div class="pp_middle"></div> \
       <div class="pp_right"></div> \
      </div> \
     </div> \
     <div class="pp_overlay"></div>',gallery_markup:'<div class="pp_gallery"> \
        <a href="#" class="pp_arrow_previous">Previous</a> \
        <div> \
         <ul> \
          {gallery} \
         </ul> \
        </div> \
        <a href="#" class="pp_arrow_next">Next</a> \
       </div>',image_markup:'<img id="fullResImage" src="{path}" />',flash_markup:'<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="{width}" height="{height}"><param name="wmode" value="{wmode}" /><param name="allowfullscreen" value="true" /><param name="allowscriptaccess" value="always" /><param name="movie" value="{path}" /><embed src="{path}" type="application/x-shockwave-flash" allowfullscreen="true" allowscriptaccess="always" width="{width}" height="{height}" wmode="{wmode}"></embed></object>',quicktime_markup:'<object classid="clsid:02BF25D5-8C17-4B23-BC80-D3488ABDDC6B" codebase="http://www.apple.com/qtactivex/qtplugin.cab" height="{height}" width="{width}"><param name="src" value="{path}"><param name="autoplay" value="{autoplay}"><param name="type" value="video/quicktime"><embed src="{path}" height="{height}" width="{width}" autoplay="{autoplay}" type="video/quicktime" pluginspage="http://www.apple.com/quicktime/download/"></embed></object>',iframe_markup:'<iframe src ="{path}" width="{width}" height="{height}" frameborder="no"></iframe>',inline_markup:'<div class="pp_inline">{content}</div>',custom_markup:'',social_tools:'<div class="twitter"><a href="http://twitter.com/share" class="twitter-share-button" data-count="none">Tweet</a><script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script></div><div class="facebook"><iframe src="//www.facebook.com/plugins/like.php?locale=en_US&href={location_href}&amp;layout=button_count&amp;show_faces=true&amp;width=500&amp;action=like&amp;font&amp;colorscheme=light&amp;height=23" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:500px; height:23px;" allowTransparency="true"></iframe></div>'},pp_settings);var matchedObjects=this,percentBased=false,pp_dimensions,pp_open,pp_contentHeight,pp_contentWidth,pp_containerHeight,pp_containerWidth,windowHeight=$(window).height(),windowWidth=$(window).width(),pp_slideshow;doresize=true,scroll_pos=_get_scroll();$(window).unbind('resize.prettyphoto').bind('resize.prettyphoto',function(){_center_overlay();_resize_overlay();});if(pp_settings.keyboard_shortcuts){$(document).unbind('keydown.prettyphoto').bind('keydown.prettyphoto',function(e){if(typeof $pp_pic_holder!='undefined'){if($pp_pic_holder.is(':visible')){switch(e.keyCode){case 37:$.prettyPhoto.changePage('previous');e.preventDefault();break;case 39:$.prettyPhoto.changePage('next');e.preventDefault();break;case 27:if(!settings.modal)
$.prettyPhoto.close();e.preventDefault();break;};};};});};$.prettyPhoto.initialize=function(){settings=pp_settings;if(settings.theme=='pp_default')settings.horizontal_padding=16;if(settings.ie6_fallback&&$.browser.msie&&parseInt($.browser.version)==6)settings.theme="light_square";theRel=$(this).attr(settings.hook);galleryRegExp=/\[(?:.*)\]/;isSet=(galleryRegExp.exec(theRel))?true:false;pp_images=(isSet)?jQuery.map(matchedObjects,function(n,i){if($(n).attr(settings.hook).indexOf(theRel)!=-1)return $(n).attr('href');}):$.makeArray($(this).attr('href'));pp_titles=(isSet)?jQuery.map(matchedObjects,function(n,i){if($(n).attr(settings.hook).indexOf(theRel)!=-1)return($(n).find('img').attr('alt'))?$(n).find('img').attr('alt'):"";}):$.makeArray($(this).find('img').attr('alt'));pp_descriptions=(isSet)?jQuery.map(matchedObjects,function(n,i){if($(n).attr(settings.hook).indexOf(theRel)!=-1)return($(n).attr('title'))?$(n).attr('title'):"";}):$.makeArray($(this).attr('title'));if(pp_images.length>settings.overlay_gallery_max)settings.overlay_gallery=false;set_position=jQuery.inArray($(this).attr('href'),pp_images);rel_index=(isSet)?set_position:$("a["+settings.hook+"^='"+theRel+"']").index($(this));_build_overlay(this);if(settings.allow_resize)
$(window).bind('scroll.prettyphoto',function(){_center_overlay();});$.prettyPhoto.open();return false;}
$.prettyPhoto.open=function(event){if(typeof settings=="undefined"){settings=pp_settings;if($.browser.msie&&$.browser.version==6)settings.theme="light_square";pp_images=$.makeArray(arguments[0]);pp_titles=(arguments[1])?$.makeArray(arguments[1]):$.makeArray("");pp_descriptions=(arguments[2])?$.makeArray(arguments[2]):$.makeArray("");isSet=(pp_images.length>1)?true:false;set_position=(arguments[3])?arguments[3]:0;_build_overlay(event.target);}
if($.browser.msie&&$.browser.version==6)$('select').css('visibility','hidden');if(settings.hideflash)$('object,embed,iframe[src*=youtube],iframe[src*=vimeo]').css('visibility','hidden');_checkPosition($(pp_images).size());$('.pp_loaderIcon').show();if(settings.deeplinking)
setHashtag();if(settings.social_tools){facebook_like_link=settings.social_tools.replace('{location_href}',encodeURIComponent(location.href));$pp_pic_holder.find('.pp_social').html(facebook_like_link);}
if($ppt.is(':hidden'))$ppt.css('opacity',0).show();$pp_overlay.show().fadeTo(settings.animation_speed,settings.opacity);$pp_pic_holder.find('.currentTextHolder').text((set_position+1)+settings.counter_separator_label+$(pp_images).size());if(typeof pp_descriptions[set_position]!='undefined'&&pp_descriptions[set_position]!=""){$pp_pic_holder.find('.pp_description').show().html(unescape(pp_descriptions[set_position]));}else{$pp_pic_holder.find('.pp_description').hide();}
movie_width=(parseFloat(getParam('width',pp_images[set_position])))?getParam('width',pp_images[set_position]):settings.default_width.toString();movie_height=(parseFloat(getParam('height',pp_images[set_position])))?getParam('height',pp_images[set_position]):settings.default_height.toString();percentBased=false;if(movie_height.indexOf('%')!=-1){movie_height=parseFloat(($(window).height()*parseFloat(movie_height)/100)-150);percentBased=true;}
if(movie_width.indexOf('%')!=-1){movie_width=parseFloat(($(window).width()*parseFloat(movie_width)/100)-150);percentBased=true;}
$pp_pic_holder.fadeIn(function(){(settings.show_title&&pp_titles[set_position]!=""&&typeof pp_titles[set_position]!="undefined")?$ppt.html(unescape(pp_titles[set_position])):$ppt.html('&nbsp;');imgPreloader="";skipInjection=false;switch(_getFileType(pp_images[set_position])){case'image':imgPreloader=new Image();nextImage=new Image();if(isSet&&set_position<$(pp_images).size()-1)nextImage.src=pp_images[set_position+1];prevImage=new Image();if(isSet&&pp_images[set_position-1])prevImage.src=pp_images[set_position-1];$pp_pic_holder.find('#pp_full_res')[0].innerHTML=settings.image_markup.replace(/{path}/g,pp_images[set_position]);imgPreloader.onload=function(){pp_dimensions=_fitToViewport(imgPreloader.width,imgPreloader.height);_showContent();};imgPreloader.onerror=function(){alert('Image cannot be loaded. Make sure the path is correct and image exist.');$.prettyPhoto.close();};imgPreloader.src=pp_images[set_position];break;case'youtube':pp_dimensions=_fitToViewport(movie_width,movie_height);movie_id=getParam('v',pp_images[set_position]);if(movie_id==""){movie_id=pp_images[set_position].split('youtu.be/');movie_id=movie_id[1];if(movie_id.indexOf('?')>0)
movie_id=movie_id.substr(0,movie_id.indexOf('?'));if(movie_id.indexOf('&')>0)
movie_id=movie_id.substr(0,movie_id.indexOf('&'));}
movie='http://www.youtube.com/embed/'+movie_id;(getParam('rel',pp_images[set_position]))?movie+="?rel="+getParam('rel',pp_images[set_position]):movie+="?rel=1";if(settings.autoplay)movie+="&autoplay=1";toInject=settings.iframe_markup.replace(/{width}/g,pp_dimensions['width']).replace(/{height}/g,pp_dimensions['height']).replace(/{wmode}/g,settings.wmode).replace(/{path}/g,movie);break;case'vimeo':pp_dimensions=_fitToViewport(movie_width,movie_height);movie_id=pp_images[set_position];var regExp=/http:\/\/(www\.)?vimeo.com\/(\d+)/;var match=movie_id.match(regExp);movie='http://player.vimeo.com/video/'+match[2]+'?title=0&amp;byline=0&amp;portrait=0';if(settings.autoplay)movie+="&autoplay=1;";vimeo_width=pp_dimensions['width']+'/embed/?moog_width='+pp_dimensions['width'];toInject=settings.iframe_markup.replace(/{width}/g,vimeo_width).replace(/{height}/g,pp_dimensions['height']).replace(/{path}/g,movie);break;case'quicktime':pp_dimensions=_fitToViewport(movie_width,movie_height);pp_dimensions['height']+=15;pp_dimensions['contentHeight']+=15;pp_dimensions['containerHeight']+=15;toInject=settings.quicktime_markup.replace(/{width}/g,pp_dimensions['width']).replace(/{height}/g,pp_dimensions['height']).replace(/{wmode}/g,settings.wmode).replace(/{path}/g,pp_images[set_position]).replace(/{autoplay}/g,settings.autoplay);break;case'flash':pp_dimensions=_fitToViewport(movie_width,movie_height);flash_vars=pp_images[set_position];flash_vars=flash_vars.substring(pp_images[set_position].indexOf('flashvars')+10,pp_images[set_position].length);filename=pp_images[set_position];filename=filename.substring(0,filename.indexOf('?'));toInject=settings.flash_markup.replace(/{width}/g,pp_dimensions['width']).replace(/{height}/g,pp_dimensions['height']).replace(/{wmode}/g,settings.wmode).replace(/{path}/g,filename+'?'+flash_vars);break;case'iframe':pp_dimensions=_fitToViewport(movie_width,movie_height);frame_url=pp_images[set_position];frame_url=frame_url.substr(0,frame_url.indexOf('iframe')-1);toInject=settings.iframe_markup.replace(/{width}/g,pp_dimensions['width']).replace(/{height}/g,pp_dimensions['height']).replace(/{path}/g,frame_url);break;case'ajax':doresize=false;pp_dimensions=_fitToViewport(movie_width,movie_height);doresize=true;skipInjection=true;$.get(pp_images[set_position],function(responseHTML){toInject=settings.inline_markup.replace(/{content}/g,responseHTML);$pp_pic_holder.find('#pp_full_res')[0].innerHTML=toInject;_showContent();});break;case'custom':pp_dimensions=_fitToViewport(movie_width,movie_height);toInject=settings.custom_markup;break;case'inline':myClone=$(pp_images[set_position]).clone().append('<br clear="all" />').css({'width':settings.default_width}).wrapInner('<div id="pp_full_res"><div class="pp_inline"></div></div>').appendTo($('body')).show();doresize=false;pp_dimensions=_fitToViewport($(myClone).width(),$(myClone).height());doresize=true;$(myClone).remove();toInject=settings.inline_markup.replace(/{content}/g,$(pp_images[set_position]).html());break;};if(!imgPreloader&&!skipInjection){$pp_pic_holder.find('#pp_full_res')[0].innerHTML=toInject;_showContent();};});return false;};$.prettyPhoto.changePage=function(direction){currentGalleryPage=0;if(direction=='previous'){set_position--;if(set_position<0)set_position=$(pp_images).size()-1;}else if(direction=='next'){set_position++;if(set_position>$(pp_images).size()-1)set_position=0;}else{set_position=direction;};rel_index=set_position;if(!doresize)doresize=true;if(settings.allow_expand){$('.pp_contract').removeClass('pp_contract').addClass('pp_expand');}
_hideContent(function(){$.prettyPhoto.open();});};$.prettyPhoto.changeGalleryPage=function(direction){if(direction=='next'){currentGalleryPage++;if(currentGalleryPage>totalPage)currentGalleryPage=0;}else if(direction=='previous'){currentGalleryPage--;if(currentGalleryPage<0)currentGalleryPage=totalPage;}else{currentGalleryPage=direction;};slide_speed=(direction=='next'||direction=='previous')?settings.animation_speed:0;slide_to=currentGalleryPage*(itemsPerPage*itemWidth);$pp_gallery.find('ul').animate({left:-slide_to},slide_speed);};$.prettyPhoto.startSlideshow=function(){if(typeof pp_slideshow=='undefined'){$pp_pic_holder.find('.pp_play').unbind('click').removeClass('pp_play').addClass('pp_pause').click(function(){$.prettyPhoto.stopSlideshow();return false;});pp_slideshow=setInterval($.prettyPhoto.startSlideshow,settings.slideshow);}else{$.prettyPhoto.changePage('next');};}
$.prettyPhoto.stopSlideshow=function(){$pp_pic_holder.find('.pp_pause').unbind('click').removeClass('pp_pause').addClass('pp_play').click(function(){$.prettyPhoto.startSlideshow();return false;});clearInterval(pp_slideshow);pp_slideshow=undefined;}
$.prettyPhoto.close=function(){if($pp_overlay.is(":animated"))return;$.prettyPhoto.stopSlideshow();$pp_pic_holder.stop().find('object,embed').css('visibility','hidden');$('div.pp_pic_holder,div.ppt,.pp_fade').fadeOut(settings.animation_speed,function(){$(this).remove();});$pp_overlay.fadeOut(settings.animation_speed,function(){if($.browser.msie&&$.browser.version==6)$('select').css('visibility','visible');if(settings.hideflash)$('object,embed,iframe[src*=youtube],iframe[src*=vimeo]').css('visibility','visible');$(this).remove();$(window).unbind('scroll.prettyphoto');clearHashtag();settings.callback();doresize=true;pp_open=false;delete settings;});};function _showContent(){$('.pp_loaderIcon').hide();projectedTop=scroll_pos['scrollTop']+((windowHeight/2)-(pp_dimensions['containerHeight']/2));if(projectedTop<0)projectedTop=0;$ppt.fadeTo(settings.animation_speed,1);$pp_pic_holder.find('.pp_content').animate({height:pp_dimensions['contentHeight'],width:pp_dimensions['contentWidth']},settings.animation_speed);$pp_pic_holder.animate({'top':projectedTop,'left':((windowWidth/2)-(pp_dimensions['containerWidth']/2)<0)?0:(windowWidth/2)-(pp_dimensions['containerWidth']/2),width:pp_dimensions['containerWidth']},settings.animation_speed,function(){$pp_pic_holder.find('.pp_hoverContainer,#fullResImage').height(pp_dimensions['height']).width(pp_dimensions['width']);$pp_pic_holder.find('.pp_fade').fadeIn(settings.animation_speed);if(isSet&&_getFileType(pp_images[set_position])=="image"){$pp_pic_holder.find('.pp_hoverContainer').show();}else{$pp_pic_holder.find('.pp_hoverContainer').hide();}
if(settings.allow_expand){if(pp_dimensions['resized']){$('a.pp_expand,a.pp_contract').show();}else{$('a.pp_expand').hide();}}
if(settings.autoplay_slideshow&&!pp_slideshow&&!pp_open)$.prettyPhoto.startSlideshow();settings.changepicturecallback();pp_open=true;});_insert_gallery();pp_settings.ajaxcallback();};function _hideContent(callback){$pp_pic_holder.find('#pp_full_res object,#pp_full_res embed').css('visibility','hidden');$pp_pic_holder.find('.pp_fade').fadeOut(settings.animation_speed,function(){$('.pp_loaderIcon').show();callback();});};function _checkPosition(setCount){(setCount>1)?$('.pp_nav').show():$('.pp_nav').hide();};function _fitToViewport(width,height){resized=false;_getDimensions(width,height);imageWidth=width,imageHeight=height;if(((pp_containerWidth>windowWidth)||(pp_containerHeight>windowHeight))&&doresize&&settings.allow_resize&&!percentBased){resized=true,fitting=false;while(!fitting){if((pp_containerWidth>windowWidth)){imageWidth=(windowWidth-200);imageHeight=(height/width)*imageWidth;}else if((pp_containerHeight>windowHeight)){imageHeight=(windowHeight-200);imageWidth=(width/height)*imageHeight;}else{fitting=true;};pp_containerHeight=imageHeight,pp_containerWidth=imageWidth;};_getDimensions(imageWidth,imageHeight);if((pp_containerWidth>windowWidth)||(pp_containerHeight>windowHeight)){_fitToViewport(pp_containerWidth,pp_containerHeight)};};return{width:Math.floor(imageWidth),height:Math.floor(imageHeight),containerHeight:Math.floor(pp_containerHeight),containerWidth:Math.floor(pp_containerWidth)+(settings.horizontal_padding*2),contentHeight:Math.floor(pp_contentHeight),contentWidth:Math.floor(pp_contentWidth),resized:resized};};function _getDimensions(width,height){width=parseFloat(width);height=parseFloat(height);$pp_details=$pp_pic_holder.find('.pp_details');$pp_details.width(width);detailsHeight=parseFloat($pp_details.css('marginTop'))+parseFloat($pp_details.css('marginBottom'));$pp_details=$pp_details.clone().addClass(settings.theme).width(width).appendTo($('body')).css({'position':'absolute','top':-10000});detailsHeight+=$pp_details.height();detailsHeight=(detailsHeight<=34)?36:detailsHeight;if($.browser.msie&&$.browser.version==7)detailsHeight+=8;$pp_details.remove();$pp_title=$pp_pic_holder.find('.ppt');$pp_title.width(width);titleHeight=parseFloat($pp_title.css('marginTop'))+parseFloat($pp_title.css('marginBottom'));$pp_title=$pp_title.clone().appendTo($('body')).css({'position':'absolute','top':-10000});titleHeight+=$pp_title.height();$pp_title.remove();pp_contentHeight=height+detailsHeight;pp_contentWidth=width;pp_containerHeight=pp_contentHeight+titleHeight+$pp_pic_holder.find('.pp_top').height()+$pp_pic_holder.find('.pp_bottom').height();pp_containerWidth=width;}
function _getFileType(itemSrc){if(itemSrc.match(/youtube\.com\/watch/i)||itemSrc.match(/youtu\.be/i)){return'youtube';}else if(itemSrc.match(/vimeo\.com/i)){return'vimeo';}else if(itemSrc.match(/\b.mov\b/i)){return'quicktime';}else if(itemSrc.match(/\b.swf\b/i)){return'flash';}else if(itemSrc.match(/\biframe=true\b/i)){return'iframe';}else if(itemSrc.match(/\bajax=true\b/i)){return'ajax';}else if(itemSrc.match(/\bcustom=true\b/i)){return'custom';}else if(itemSrc.substr(0,1)=='#'){return'inline';}else{return'image';};};function _center_overlay(){if(doresize&&typeof $pp_pic_holder!='undefined'){scroll_pos=_get_scroll();contentHeight=$pp_pic_holder.height(),contentwidth=$pp_pic_holder.width();projectedTop=(windowHeight/2)+scroll_pos['scrollTop']-(contentHeight/2);if(projectedTop<0)projectedTop=0;if(contentHeight>windowHeight)
return;$pp_pic_holder.css({'top':projectedTop,'left':(windowWidth/2)+scroll_pos['scrollLeft']-(contentwidth/2)});};};function _get_scroll(){if(self.pageYOffset){return{scrollTop:self.pageYOffset,scrollLeft:self.pageXOffset};}else if(document.documentElement&&document.documentElement.scrollTop){return{scrollTop:document.documentElement.scrollTop,scrollLeft:document.documentElement.scrollLeft};}else if(document.body){return{scrollTop:document.body.scrollTop,scrollLeft:document.body.scrollLeft};};};function _resize_overlay(){windowHeight=$(window).height(),windowWidth=$(window).width();if(typeof $pp_overlay!="undefined")$pp_overlay.height($(document).height()).width(windowWidth);};function _insert_gallery(){if(isSet&&settings.overlay_gallery&&_getFileType(pp_images[set_position])=="image"&&(settings.ie6_fallback&&!($.browser.msie&&parseInt($.browser.version)==6))){itemWidth=52+5;navWidth=(settings.theme=="facebook"||settings.theme=="pp_default")?50:30;itemsPerPage=Math.floor((pp_dimensions['containerWidth']-100-navWidth)/itemWidth);itemsPerPage=(itemsPerPage<pp_images.length)?itemsPerPage:pp_images.length;totalPage=Math.ceil(pp_images.length/itemsPerPage)-1;if(totalPage==0){navWidth=0;$pp_gallery.find('.pp_arrow_next,.pp_arrow_previous').hide();}else{$pp_gallery.find('.pp_arrow_next,.pp_arrow_previous').show();};galleryWidth=itemsPerPage*itemWidth;fullGalleryWidth=pp_images.length*itemWidth;$pp_gallery.css('margin-left',-((galleryWidth/2)+(navWidth/2))).find('div:first').width(galleryWidth+5).find('ul').width(fullGalleryWidth).find('li.selected').removeClass('selected');goToPage=(Math.floor(set_position/itemsPerPage)<totalPage)?Math.floor(set_position/itemsPerPage):totalPage;$.prettyPhoto.changeGalleryPage(goToPage);$pp_gallery_li.filter(':eq('+set_position+')').addClass('selected');}else{$pp_pic_holder.find('.pp_content').unbind('mouseenter mouseleave');}}
function _build_overlay(caller){if(settings.social_tools)
facebook_like_link=settings.social_tools.replace('{location_href}',encodeURIComponent(location.href));settings.markup=settings.markup.replace('{pp_social}','');$('body').append(settings.markup);$pp_pic_holder=$('.pp_pic_holder'),$ppt=$('.ppt'),$pp_overlay=$('div.pp_overlay');if(isSet&&settings.overlay_gallery){currentGalleryPage=0;toInject="";for(var i=0;i<pp_images.length;i++){if(!pp_images[i].match(/\b(jpg|jpeg|png|gif)\b/gi)){classname='default';img_src='';}else{classname='';img_src=pp_images[i];}
toInject+="<li class='"+classname+"'><a href='#'><img src='"+img_src+"' width='50' alt='' /></a></li>";};toInject=settings.gallery_markup.replace(/{gallery}/g,toInject);$pp_pic_holder.find('#pp_full_res').after(toInject);$pp_gallery=$('.pp_pic_holder .pp_gallery'),$pp_gallery_li=$pp_gallery.find('li');$pp_gallery.find('.pp_arrow_next').click(function(){$.prettyPhoto.changeGalleryPage('next');$.prettyPhoto.stopSlideshow();return false;});$pp_gallery.find('.pp_arrow_previous').click(function(){$.prettyPhoto.changeGalleryPage('previous');$.prettyPhoto.stopSlideshow();return false;});$pp_pic_holder.find('.pp_content').hover(function(){$pp_pic_holder.find('.pp_gallery:not(.disabled)').fadeIn();},function(){$pp_pic_holder.find('.pp_gallery:not(.disabled)').fadeOut();});itemWidth=52+5;$pp_gallery_li.each(function(i){$(this).find('a').click(function(){$.prettyPhoto.changePage(i);$.prettyPhoto.stopSlideshow();return false;});});};if(settings.slideshow){$pp_pic_holder.find('.pp_nav').prepend('<a href="#" class="pp_play">Play</a>')
$pp_pic_holder.find('.pp_nav .pp_play').click(function(){$.prettyPhoto.startSlideshow();return false;});}
$pp_pic_holder.attr('class','pp_pic_holder '+settings.theme);$pp_overlay.css({'opacity':0,'height':$(document).height(),'width':$(window).width()}).bind('click',function(){if(!settings.modal)$.prettyPhoto.close();});$('a.pp_close').bind('click',function(){$.prettyPhoto.close();return false;});if(settings.allow_expand){$('a.pp_expand').bind('click',function(e){if($(this).hasClass('pp_expand')){$(this).removeClass('pp_expand').addClass('pp_contract');doresize=false;}else{$(this).removeClass('pp_contract').addClass('pp_expand');doresize=true;};_hideContent(function(){$.prettyPhoto.open();});return false;});}
$pp_pic_holder.find('.pp_previous, .pp_nav .pp_arrow_previous').bind('click',function(){$.prettyPhoto.changePage('previous');$.prettyPhoto.stopSlideshow();return false;});$pp_pic_holder.find('.pp_next, .pp_nav .pp_arrow_next').bind('click',function(){$.prettyPhoto.changePage('next');$.prettyPhoto.stopSlideshow();return false;});_center_overlay();};if(!pp_alreadyInitialized&&getHashtag()){pp_alreadyInitialized=true;hashIndex=getHashtag();hashRel=hashIndex;hashIndex=hashIndex.substring(hashIndex.indexOf('/')+1,hashIndex.length-1);hashRel=hashRel.substring(0,hashRel.indexOf('/'));setTimeout(function(){$("a["+pp_settings.hook+"^='"+hashRel+"']:eq("+hashIndex+")").trigger('click');},50);}
return this.unbind('click.prettyphoto').bind('click.prettyphoto',$.prettyPhoto.initialize);};function getHashtag(){url=location.href;hashtag=(url.indexOf('#prettyPhoto')!==-1)?decodeURI(url.substring(url.indexOf('#prettyPhoto')+1,url.length)):false;return hashtag;};function setHashtag(){if(typeof theRel=='undefined')return;location.hash=theRel+'/'+rel_index+'/';};function clearHashtag(){if(location.href.indexOf('#prettyPhoto')!==-1)location.hash="prettyPhoto";}
function getParam(name,url){name=name.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");var regexS="[\\?&]"+name+"=([^&#]*)";var regex=new RegExp(regexS);var results=regex.exec(url);return(results==null)?"":results[1];}})(jQuery);var pp_alreadyInitialized=false;
/* end of /whb/wp-content/themes/envision-parent/framework/static/javascript/jquery.prettyPhoto.js */
jQuery.bt={version:'0.9.5-rc1'};;(function($){jQuery.fn.bt=function(content,options){if(typeof content!='string'){var contentSelect=true;options=content;content=false;}
else{var contentSelect=false;}
if(jQuery.fn.hoverIntent&&jQuery.bt.defaults.trigger=='hover'){jQuery.bt.defaults.trigger='hoverIntent';}
return this.each(function(index){var opts=jQuery.extend(false,jQuery.bt.defaults,jQuery.bt.options,options);opts.spikeLength=numb(opts.spikeLength);opts.spikeGirth=numb(opts.spikeGirth);opts.overlap=numb(opts.overlap);var ajaxTimeout=false;if(opts.killTitle){$(this).find('[title]').andSelf().each(function(){if(!$(this).attr('bt-xTitle')){$(this).attr('bt-xTitle',$(this).attr('title'));$(this).attr('title','');}});}
if(typeof opts.trigger=='string'){opts.trigger=[opts.trigger];}
if(opts.trigger[0]=='hoverIntent'){var hoverOpts=jQuery.extend(opts.hoverIntentOpts,{over:function(){this.btOn();},out:function(){this.btOff();}});$(this).hoverIntent(hoverOpts);}
else if(opts.trigger[0]=='hover'){$(this).hover(function(){this.btOn();},function(){this.btOff();});}
else if(opts.trigger[0]=='now'){if($(this).hasClass('bt-active')){this.btOff();}
else{this.btOn();}}
else if(opts.trigger[0]=='none'){}
else if(opts.trigger.length>1&&opts.trigger[0]!=opts.trigger[1]){$(this).bind(opts.trigger[0],function(){this.btOn();}).bind(opts.trigger[1],function(){this.btOff();});}
else{$(this).bind(opts.trigger[0],function(){if($(this).hasClass('bt-active')){this.btOff();}
else{this.btOn();}});}
this.btOn=function(){if(typeof $(this).data('bt-box')=='object'){this.btOff();}
opts.preBuild.apply(this);$(jQuery.bt.vars.closeWhenOpenStack).btOff();$(this).addClass('bt-active '+opts.activeClass);if(contentSelect&&opts.ajaxPath==null){if(opts.killTitle){$(this).attr('title',$(this).attr('bt-xTitle'));}
content=$.isFunction(opts.contentSelector)?opts.contentSelector.apply(this):eval(opts.contentSelector);if(opts.killTitle){$(this).attr('title','');}}
if(opts.ajaxPath!=null&&content==false){if(typeof opts.ajaxPath=='object'){var url=eval(opts.ajaxPath[0]);url+=opts.ajaxPath[1]?' '+opts.ajaxPath[1]:'';}
else{var url=opts.ajaxPath;}
var off=url.indexOf(" ");if(off>=0){var selector=url.slice(off,url.length);url=url.slice(0,off);}
var cacheData=opts.ajaxCache?$(document.body).data('btCache-'+url.replace(/\./g,'')):null;if(typeof cacheData=='string'){content=selector?$("<div/>").append(cacheData.replace(/<script(.|\s)*?\/script>/g,"")).find(selector):cacheData;}
else{var target=this;var ajaxOpts=jQuery.extend(false,{type:opts.ajaxType,data:opts.ajaxData,cache:opts.ajaxCache,url:url,complete:function(XMLHttpRequest,textStatus){if(textStatus=='success'||textStatus=='notmodified'){if(opts.ajaxCache){$(document.body).data('btCache-'+url.replace(/\./g,''),XMLHttpRequest.responseText);}
ajaxTimeout=false;content=selector?$("<div/>").append(XMLHttpRequest.responseText.replace(/<script(.|\s)*?\/script>/g,"")).find(selector):XMLHttpRequest.responseText;}
else{if(textStatus=='timeout'){ajaxTimeout=true;}
content=opts.ajaxError.replace(/%error/g,XMLHttpRequest.statusText);}
if($(target).hasClass('bt-active')){target.btOn();}}},opts.ajaxOpts);jQuery.ajax(ajaxOpts);content=opts.ajaxLoading;}}
var shadowMarginX=0;var shadowMarginY=0;var shadowShiftX=0;var shadowShiftY=0;if(opts.shadow&&!shadowSupport()){opts.shadow=false;jQuery.extend(opts,opts.noShadowOpts);}
if(opts.shadow){if(opts.shadowBlur>Math.abs(opts.shadowOffsetX)){shadowMarginX=opts.shadowBlur*2;}
else{shadowMarginX=opts.shadowBlur+Math.abs(opts.shadowOffsetX);}
shadowShiftX=(opts.shadowBlur-opts.shadowOffsetX)>0?opts.shadowBlur-opts.shadowOffsetX:0;if(opts.shadowBlur>Math.abs(opts.shadowOffsetY)){shadowMarginY=opts.shadowBlur*2;}
else{shadowMarginY=opts.shadowBlur+Math.abs(opts.shadowOffsetY);}
shadowShiftY=(opts.shadowBlur-opts.shadowOffsetY)>0?opts.shadowBlur-opts.shadowOffsetY:0;}
if(opts.offsetParent){var offsetParent=$(opts.offsetParent);var offsetParentPos=offsetParent.offset();var pos=$(this).offset();var top=numb(pos.top)-numb(offsetParentPos.top)+numb($(this).css('margin-top'))-shadowShiftY;var left=numb(pos.left)-numb(offsetParentPos.left)+numb($(this).css('margin-left'))-shadowShiftX;}
else{var offsetParent=($(this).css('position')=='absolute')?$(this).parents().eq(0).offsetParent():$(this).offsetParent();var pos=$(this).btPosition();var top=numb(pos.top)+numb($(this).css('margin-top'))-shadowShiftY;var left=numb(pos.left)+numb($(this).css('margin-left'))-shadowShiftX;}
var width=$(this).btOuterWidth();var height=$(this).outerHeight();if(typeof content=='object'){var original=content;var clone=$(original).clone(true).show();var origClones=$(original).data('bt-clones')||[];origClones.push(clone);$(original).data('bt-clones',origClones);$(clone).data('bt-orig',original);$(this).data('bt-content-orig',{original:original,clone:clone});content=clone;}
if(typeof content=='null'||content==''){return;}
var $text=$('<div class="bt-content"></div>').append(content).css({padding:opts.padding,position:'absolute',maxWidth:(opts.shrinkToFit?'auto':opts.width),zIndex:opts.textzIndex,left:shadowShiftX,top:shadowShiftY}).css(opts.cssStyles);var $box=$('<div class="bt-wrapper"></div>').append($text).addClass(opts.cssClass).css({position:'absolute',maxWidth:opts.width,zIndex:opts.wrapperzIndex,visibility:'hidden'}).appendTo(offsetParent);if(jQuery.fn.bgiframe){$text.bgiframe();$box.bgiframe();}
$(this).data('bt-box',$box);var scrollTop=numb($(document).scrollTop());var scrollLeft=numb($(document).scrollLeft());var docWidth=numb($(window).width());var docHeight=numb($(window).height());var winRight=scrollLeft+docWidth;var winBottom=scrollTop+docHeight;var space=new Object();var thisOffset=$(this).offset();space.top=thisOffset.top-scrollTop;space.bottom=docHeight-((thisOffset+height)-scrollTop);space.left=thisOffset.left-scrollLeft;space.right=docWidth-((thisOffset.left+width)-scrollLeft);var textOutHeight=numb($text.outerHeight());var textOutWidth=numb($text.btOuterWidth());if(opts.positions.constructor==String){opts.positions=opts.positions.replace(/ /,'').split(',');}
if(opts.positions[0]=='most'){var position='top';for(var pig in space){position=space[pig]>space[position]?pig:position;}}
else{for(var x in opts.positions){var position=opts.positions[x];if((position=='left'||position=='right')&&space[position]>textOutWidth+opts.spikeLength){break;}
else if((position=='top'||position=='bottom')&&space[position]>textOutHeight+opts.spikeLength){break;}}}
var horiz=left+((width-textOutWidth)*.5);var vert=top+((height-textOutHeight)*.5);var points=new Array();var textTop,textLeft,textRight,textBottom,textTopSpace,textBottomSpace,textLeftSpace,textRightSpace,crossPoint,textCenter,spikePoint;switch(position){case'top':$text.css('margin-bottom',opts.spikeLength+'px');$box.css({top:(top-$text.outerHeight(true))+opts.overlap,left:horiz});textRightSpace=(winRight-opts.windowMargin)-($text.offset().left+$text.btOuterWidth(true));var xShift=shadowShiftX;if(textRightSpace<0){$box.css('left',(numb($box.css('left'))+textRightSpace)+'px');xShift-=textRightSpace;}
textLeftSpace=($text.offset().left+numb($text.css('margin-left')))-(scrollLeft+opts.windowMargin);if(textLeftSpace<0){$box.css('left',(numb($box.css('left'))-textLeftSpace)+'px');xShift+=textLeftSpace;}
textTop=$text.btPosition().top+numb($text.css('margin-top'));textLeft=$text.btPosition().left+numb($text.css('margin-left'));textRight=textLeft+$text.btOuterWidth();textBottom=textTop+$text.outerHeight();textCenter={x:textLeft+($text.btOuterWidth()*opts.centerPointX),y:textTop+($text.outerHeight()*opts.centerPointY)};points[points.length]=spikePoint={y:textBottom+opts.spikeLength,x:((textRight-textLeft)*.5)+xShift,type:'spike'};crossPoint=findIntersectX(spikePoint.x,spikePoint.y,textCenter.x,textCenter.y,textBottom);crossPoint.x=crossPoint.x<textLeft+opts.spikeGirth/2+opts.cornerRadius?textLeft+opts.spikeGirth/2+opts.cornerRadius:crossPoint.x;crossPoint.x=crossPoint.x>(textRight-opts.spikeGirth/2)-opts.cornerRadius?(textRight-opts.spikeGirth/2)-opts.CornerRadius:crossPoint.x;points[points.length]={x:crossPoint.x-(opts.spikeGirth/2),y:textBottom,type:'join'};points[points.length]={x:textLeft,y:textBottom,type:'corner'};points[points.length]={x:textLeft,y:textTop,type:'corner'};points[points.length]={x:textRight,y:textTop,type:'corner'};points[points.length]={x:textRight,y:textBottom,type:'corner'};points[points.length]={x:crossPoint.x+(opts.spikeGirth/2),y:textBottom,type:'join'};points[points.length]=spikePoint;break;case'left':$text.css('margin-right',opts.spikeLength+'px');$box.css({top:vert+'px',left:((left-$text.btOuterWidth(true))+opts.overlap)+'px'});textBottomSpace=(winBottom-opts.windowMargin)-($text.offset().top+$text.outerHeight(true));var yShift=shadowShiftY;if(textBottomSpace<0){$box.css('top',(numb($box.css('top'))+textBottomSpace)+'px');yShift-=textBottomSpace;}
textTopSpace=($text.offset().top+numb($text.css('margin-top')))-(scrollTop+opts.windowMargin);if(textTopSpace<0){$box.css('top',(numb($box.css('top'))-textTopSpace)+'px');yShift+=textTopSpace;}
textTop=$text.btPosition().top+numb($text.css('margin-top'));textLeft=$text.btPosition().left+numb($text.css('margin-left'));textRight=textLeft+$text.btOuterWidth();textBottom=textTop+$text.outerHeight();textCenter={x:textLeft+($text.btOuterWidth()*opts.centerPointX),y:textTop+($text.outerHeight()*opts.centerPointY)};points[points.length]=spikePoint={x:textRight+opts.spikeLength,y:((textBottom-textTop)*.5)+yShift,type:'spike'};crossPoint=findIntersectY(spikePoint.x,spikePoint.y,textCenter.x,textCenter.y,textRight);crossPoint.y=crossPoint.y<textTop+opts.spikeGirth/2+opts.cornerRadius?textTop+opts.spikeGirth/2+opts.cornerRadius:crossPoint.y;crossPoint.y=crossPoint.y>(textBottom-opts.spikeGirth/2)-opts.cornerRadius?(textBottom-opts.spikeGirth/2)-opts.cornerRadius:crossPoint.y;points[points.length]={x:textRight,y:crossPoint.y+opts.spikeGirth/2,type:'join'};points[points.length]={x:textRight,y:textBottom,type:'corner'};points[points.length]={x:textLeft,y:textBottom,type:'corner'};points[points.length]={x:textLeft,y:textTop,type:'corner'};points[points.length]={x:textRight,y:textTop,type:'corner'};points[points.length]={x:textRight,y:crossPoint.y-opts.spikeGirth/2,type:'join'};points[points.length]=spikePoint;break;case'bottom':$text.css('margin-top',opts.spikeLength+'px');$box.css({top:(top+height)-opts.overlap,left:horiz});textRightSpace=(winRight-opts.windowMargin)-($text.offset().left+$text.btOuterWidth(true));var xShift=shadowShiftX;if(textRightSpace<0){$box.css('left',(numb($box.css('left'))+textRightSpace)+'px');xShift-=textRightSpace;}
textLeftSpace=($text.offset().left+numb($text.css('margin-left')))-(scrollLeft+opts.windowMargin);if(textLeftSpace<0){$box.css('left',(numb($box.css('left'))-textLeftSpace)+'px');xShift+=textLeftSpace;}
textTop=$text.btPosition().top+numb($text.css('margin-top'));textLeft=$text.btPosition().left+numb($text.css('margin-left'));textRight=textLeft+$text.btOuterWidth();textBottom=textTop+$text.outerHeight();textCenter={x:textLeft+($text.btOuterWidth()*opts.centerPointX),y:textTop+($text.outerHeight()*opts.centerPointY)};points[points.length]=spikePoint={x:((textRight-textLeft)*.5)+xShift,y:shadowShiftY,type:'spike'};crossPoint=findIntersectX(spikePoint.x,spikePoint.y,textCenter.x,textCenter.y,textTop);crossPoint.x=crossPoint.x<textLeft+opts.spikeGirth/2+opts.cornerRadius?textLeft+opts.spikeGirth/2+opts.cornerRadius:crossPoint.x;crossPoint.x=crossPoint.x>(textRight-opts.spikeGirth/2)-opts.cornerRadius?(textRight-opts.spikeGirth/2)-opts.cornerRadius:crossPoint.x;points[points.length]={x:crossPoint.x+opts.spikeGirth/2,y:textTop,type:'join'};points[points.length]={x:textRight,y:textTop,type:'corner'};points[points.length]={x:textRight,y:textBottom,type:'corner'};points[points.length]={x:textLeft,y:textBottom,type:'corner'};points[points.length]={x:textLeft,y:textTop,type:'corner'};points[points.length]={x:crossPoint.x-(opts.spikeGirth/2),y:textTop,type:'join'};points[points.length]=spikePoint;break;case'right':$text.css('margin-left',(opts.spikeLength+'px'));$box.css({top:vert+'px',left:((left+width)-opts.overlap)+'px'});textBottomSpace=(winBottom-opts.windowMargin)-($text.offset().top+$text.outerHeight(true));var yShift=shadowShiftY;if(textBottomSpace<0){$box.css('top',(numb($box.css('top'))+textBottomSpace)+'px');yShift-=textBottomSpace;}
textTopSpace=($text.offset().top+numb($text.css('margin-top')))-(scrollTop+opts.windowMargin);if(textTopSpace<0){$box.css('top',(numb($box.css('top'))-textTopSpace)+'px');yShift+=textTopSpace;}
textTop=$text.btPosition().top+numb($text.css('margin-top'));textLeft=$text.btPosition().left+numb($text.css('margin-left'));textRight=textLeft+$text.btOuterWidth();textBottom=textTop+$text.outerHeight();textCenter={x:textLeft+($text.btOuterWidth()*opts.centerPointX),y:textTop+($text.outerHeight()*opts.centerPointY)};points[points.length]=spikePoint={x:shadowShiftX,y:((textBottom-textTop)*.5)+yShift,type:'spike'};crossPoint=findIntersectY(spikePoint.x,spikePoint.y,textCenter.x,textCenter.y,textLeft);crossPoint.y=crossPoint.y<textTop+opts.spikeGirth/2+opts.cornerRadius?textTop+opts.spikeGirth/2+opts.cornerRadius:crossPoint.y;crossPoint.y=crossPoint.y>(textBottom-opts.spikeGirth/2)-opts.cornerRadius?(textBottom-opts.spikeGirth/2)-opts.cornerRadius:crossPoint.y;points[points.length]={x:textLeft,y:crossPoint.y-opts.spikeGirth/2,type:'join'};points[points.length]={x:textLeft,y:textTop,type:'corner'};points[points.length]={x:textRight,y:textTop,type:'corner'};points[points.length]={x:textRight,y:textBottom,type:'corner'};points[points.length]={x:textLeft,y:textBottom,type:'corner'};points[points.length]={x:textLeft,y:crossPoint.y+opts.spikeGirth/2,type:'join'};points[points.length]=spikePoint;break;}
var canvas=document.createElement('canvas');$(canvas).attr('width',(numb($text.btOuterWidth(true))+opts.strokeWidth*2+shadowMarginX)).attr('height',(numb($text.outerHeight(true))+opts.strokeWidth*2+shadowMarginY)).appendTo($box).css({position:'absolute',zIndex:opts.boxzIndex});if(typeof G_vmlCanvasManager!='undefined'){canvas=G_vmlCanvasManager.initElement(canvas);}
if(opts.cornerRadius>0){var newPoints=new Array();var newPoint;for(var i=0;i<points.length;i++){if(points[i].type=='corner'){newPoint=betweenPoint(points[i],points[(i-1)%points.length],opts.cornerRadius);newPoint.type='arcStart';newPoints[newPoints.length]=newPoint;newPoints[newPoints.length]=points[i];newPoint=betweenPoint(points[i],points[(i+1)%points.length],opts.cornerRadius);newPoint.type='arcEnd';newPoints[newPoints.length]=newPoint;}
else{newPoints[newPoints.length]=points[i];}}
points=newPoints;}
var ctx=canvas.getContext("2d");if(opts.shadow&&opts.shadowOverlap!==true){var shadowOverlap=numb(opts.shadowOverlap);switch(position){case'top':if(opts.shadowOffsetX+opts.shadowBlur-shadowOverlap>0){$box.css('top',(numb($box.css('top'))-(opts.shadowOffsetX+opts.shadowBlur-shadowOverlap)));}
break;case'right':if(shadowShiftX-shadowOverlap>0){$box.css('left',(numb($box.css('left'))+shadowShiftX-shadowOverlap));}
break;case'bottom':if(shadowShiftY-shadowOverlap>0){$box.css('top',(numb($box.css('top'))+shadowShiftY-shadowOverlap));}
break;case'left':if(opts.shadowOffsetY+opts.shadowBlur-shadowOverlap>0){$box.css('left',(numb($box.css('left'))-(opts.shadowOffsetY+opts.shadowBlur-shadowOverlap)));}
break;}}
drawIt.apply(ctx,[points],opts.strokeWidth);ctx.fillStyle=opts.fill;if(opts.shadow){ctx.shadowOffsetX=opts.shadowOffsetX;ctx.shadowOffsetY=opts.shadowOffsetY;ctx.shadowBlur=opts.shadowBlur;ctx.shadowColor=opts.shadowColor;}
ctx.closePath();ctx.fill();if(opts.strokeWidth>0){ctx.shadowColor='rgba(0, 0, 0, 0)';ctx.lineWidth=opts.strokeWidth;ctx.strokeStyle=opts.strokeStyle;ctx.beginPath();drawIt.apply(ctx,[points],opts.strokeWidth);ctx.closePath();ctx.stroke();}
opts.preShow.apply(this,[$box[0]]);$box.css({display:'none',visibility:'visible'});opts.showTip.apply(this,[$box[0]]);if(opts.overlay){var overlay=$('<div class="bt-overlay"></div>').css({position:'absolute',backgroundColor:'blue',top:top,left:left,width:width,height:height,opacity:'.2'}).appendTo(offsetParent);$(this).data('overlay',overlay);}
if((opts.ajaxPath!=null&&opts.ajaxCache==false)||ajaxTimeout){content=false;}
if(opts.clickAnywhereToClose){jQuery.bt.vars.clickAnywhereStack.push(this);$(document).click(jQuery.bt.docClick);}
if(opts.closeWhenOthersOpen){jQuery.bt.vars.closeWhenOpenStack.push(this);}
opts.postShow.apply(this,[$box[0]]);};this.btOff=function(){var box=$(this).data('bt-box');opts.preHide.apply(this,[box]);var i=this;i.btCleanup=function(){var box=$(i).data('bt-box');var contentOrig=$(i).data('bt-content-orig');var overlay=$(i).data('bt-overlay');if(typeof box=='object'){$(box).remove();$(i).removeData('bt-box');}
if(typeof contentOrig=='object'){var clones=$(contentOrig.original).data('bt-clones');$(contentOrig).data('bt-clones',arrayRemove(clones,contentOrig.clone));}
if(typeof overlay=='object'){$(overlay).remove();$(i).removeData('bt-overlay');}
jQuery.bt.vars.clickAnywhereStack=arrayRemove(jQuery.bt.vars.clickAnywhereStack,i);jQuery.bt.vars.closeWhenOpenStack=arrayRemove(jQuery.bt.vars.closeWhenOpenStack,i);$(i).removeClass('bt-active '+opts.activeClass);opts.postHide.apply(i);}
opts.hideTip.apply(this,[box,i.btCleanup]);};var refresh=this.btRefresh=function(){this.btOff();this.btOn();};opts.loadThumb.apply(this);});function drawIt(points,strokeWidth){this.moveTo(points[0].x,points[0].y);for(i=1;i<points.length;i++){if(points[i-1].type=='arcStart'){this.quadraticCurveTo(round5(points[i].x,strokeWidth),round5(points[i].y,strokeWidth),round5(points[(i+1)%points.length].x,strokeWidth),round5(points[(i+1)%points.length].y,strokeWidth));i++;}
else{this.lineTo(round5(points[i].x,strokeWidth),round5(points[i].y,strokeWidth));}}};function round5(num,strokeWidth){var ret;strokeWidth=numb(strokeWidth);if(strokeWidth%2){ret=num;}
else{ret=Math.round(num-.5)+.5;}
return ret;};function numb(num){return parseInt(num)||0;};function arrayRemove(arr,elem){var x,newArr=new Array();for(x in arr){if(arr[x]!=elem){newArr.push(arr[x]);}}
return newArr;};function canvasSupport(){var canvas_compatible=false;try{canvas_compatible=!!(document.createElement('canvas').getContext('2d'));}catch(e){canvas_compatible=!!(document.createElement('canvas').getContext);}
return canvas_compatible;}
function shadowSupport(){try{var userAgent=navigator.userAgent.toLowerCase();if(/webkit/.test(userAgent)){return true;}
else if(/gecko|mozilla/.test(userAgent)&&parseFloat(userAgent.match(/firefox\/(\d+(?:\.\d+)+)/)[1])>=3.1){return true;}}
catch(err){}
return false;}
function betweenPoint(point1,point2,dist){var y,x;if(point1.x==point2.x){y=point1.y<point2.y?point1.y+dist:point1.y-dist;return{x:point1.x,y:y};}
else if(point1.y==point2.y){x=point1.x<point2.x?point1.x+dist:point1.x-dist;return{x:x,y:point1.y};}};function centerPoint(arcStart,corner,arcEnd){var x=corner.x==arcStart.x?arcEnd.x:arcStart.x;var y=corner.y==arcStart.y?arcEnd.y:arcStart.y;var startAngle,endAngle;if(arcStart.x<arcEnd.x){if(arcStart.y>arcEnd.y){startAngle=(Math.PI/180)*180;endAngle=(Math.PI/180)*90;}
else{startAngle=(Math.PI/180)*90;endAngle=0;}}
else{if(arcStart.y>arcEnd.y){startAngle=(Math.PI/180)*270;endAngle=(Math.PI/180)*180;}
else{startAngle=0;endAngle=(Math.PI/180)*270;}}
return{x:x,y:y,type:'center',startAngle:startAngle,endAngle:endAngle};};function findIntersect(r1x1,r1y1,r1x2,r1y2,r2x1,r2y1,r2x2,r2y2){if(r2x1==r2x2){return findIntersectY(r1x1,r1y1,r1x2,r1y2,r2x1);}
if(r2y1==r2y2){return findIntersectX(r1x1,r1y1,r1x2,r1y2,r2y1);}
var r1m=(r1y1-r1y2)/(r1x1-r1x2);var r1b=r1y1-(r1m*r1x1);var r2m=(r2y1-r2y2)/(r2x1-r2x2);var r2b=r2y1-(r2m*r2x1);var x=(r2b-r1b)/(r1m-r2m);var y=r1m*x+r1b;return{x:x,y:y};};function findIntersectY(r1x1,r1y1,r1x2,r1y2,x){if(r1y1==r1y2){return{x:x,y:r1y1};}
var r1m=(r1y1-r1y2)/(r1x1-r1x2);var r1b=r1y1-(r1m*r1x1);var y=r1m*x+r1b;return{x:x,y:y};};function findIntersectX(r1x1,r1y1,r1x2,r1y2,y){if(r1x1==r1x2){return{x:r1x1,y:y};}
var r1m=(r1y1-r1y2)/(r1x1-r1x2);var r1b=r1y1-(r1m*r1x1);var x=(y-r1b)/r1m;return{x:x,y:y};};};jQuery.fn.btPosition=function(){function num(elem,prop){return elem[0]&&parseInt(jQuery.css(elem[0],prop,true),10)||0;};var left=0,top=0,results;if(this[0]){var offsetParent=this.offsetParent(),offset=this.offset(),parentOffset=/^body|html$/i.test(offsetParent[0].tagName)?{top:0,left:0}:offsetParent.offset();offset.top-=num(this,'marginTop');offset.left-=num(this,'marginLeft');parentOffset.top+=num(offsetParent,'borderTopWidth');parentOffset.left+=num(offsetParent,'borderLeftWidth');results={top:offset.top-parentOffset.top,left:offset.left-parentOffset.left};}
return results;};jQuery.fn.btOuterWidth=function(margin){function num(elem,prop){return elem[0]&&parseInt(jQuery.css(elem[0],prop,true),10)||0;};return this["innerWidth"]()
+num(this,"borderLeftWidth")
+num(this,"borderRightWidth")
+(margin?num(this,"marginLeft")
+num(this,"marginRight"):0);};jQuery.fn.btOn=function(){return this.each(function(index){if(jQuery.isFunction(this.btOn)){this.btOn();}});};jQuery.fn.btOff=function(){return this.each(function(index){if(jQuery.isFunction(this.btOff)){this.btOff();}});};jQuery.bt.vars={clickAnywhereStack:[],closeWhenOpenStack:[]};jQuery.bt.docClick=function(e){if(!e){var e=window.event;};if(!$(e.target).parents().andSelf().filter('.bt-wrapper, .bt-active').length&&jQuery.bt.vars.clickAnywhereStack.length){$(jQuery.bt.vars.clickAnywhereStack).btOff();$(document).unbind('click',jQuery.bt.docClick);}};jQuery.bt.defaults={trigger:'hover',clickAnywhereToClose:true,closeWhenOthersOpen:false,shrinkToFit:false,width:'200px',padding:'10px',spikeGirth:10,spikeLength:15,overlap:0,overlay:false,killTitle:true,textzIndex:9999,boxzIndex:9998,wrapperzIndex:9997,offsetParent:null,positions:['most'],fill:"rgb(255, 255, 102)",windowMargin:10,strokeWidth:1,strokeStyle:"#000",cornerRadius:5,centerPointX:.5,centerPointY:.5,shadow:false,shadowOffsetX:2,shadowOffsetY:2,shadowBlur:3,shadowColor:"#000",shadowOverlap:false,noShadowOpts:{strokeStyle:'#999'},cssClass:'',cssStyles:{},activeClass:'bt-active',contentSelector:"$(this).attr('title')",ajaxPath:null,ajaxError:'<strong>ERROR:</strong> <em>%error</em>',ajaxLoading:'<blink>Loading...</blink>',ajaxData:{},ajaxType:'GET',ajaxCache:true,ajaxOpts:{},loadThumb:function(){},preBuild:function(){},preShow:function(box){},showTip:function(box){$(box).show();},postShow:function(box){},preHide:function(box){},hideTip:function(box,callback){$(box).hide();callback();},postHide:function(){},hoverIntentOpts:{interval:300,timeout:500}};jQuery.bt.options={};})(jQuery);
/* end of /whb/wp-content/themes/envision-parent/framework/static/javascript/jquery.bt.js */
var tf_new_taxonomy_links=null;jQuery(document).ready(function($)
{var tf_meta_tabs=$(".tf_meta_tabs");if(tf_meta_tabs.length){tf_meta_tabs.tabs().show();setTimeout(function(){TFE.trigger('tf-tabs-loading-finish');},100);}
$(".tf_load_meta_tabs").hide();$("a[rel^='prettyPhoto']").prettyPhoto({social_tools:false});$('#install_btn').click(function(){$('.demoinstall, .skipinstall').hide();$('.install_loading').show();});if(tf_script!=undefined&&tf_script.disable_wpbodycontent_overflow)
$('#wpbody-content').css('overflow','');$('.how_to_populate .selector').live('change',function()
{$(this).nextAll('span').css({display:'none'});$(this).nextAll('.selected_'+$(this).val()).css({display:'block'});});$('#newspromo_iframe').load(function()
{$(this).show();});$(window).scroll(function()
{$('#tfuse-popup-save').center();$('#tfuse-popup-reset').center();$('#tfuse-popup-fail').center();$('#tfuse-ajax-loading-img').center();});tf_form_bind_ajax_submit($('#tfuse_admin_options_form'),{action:'tfuse_ajax_mojax',tf_action:'ajax_admin_save_options'});$('.tfuse_fields form .postbox').removeClass('if-js-closed').addClass('closed');$('.tfuse_fields form .tf_meta_tabs .ui-tabs-panel .postbox:first-child',this).removeClass('closed');$('body').on('click','.option .tfuse-meta-radio-img-img',function(){optid=$(this).parents('.option').attr('option');old_val=opt_get(optid);new_val=$(this).attr('optval');opt_set(optid,new_val);if(old_val!=new_val)
$('[name="'+optid+'"][value="'+new_val+'"]').change();});(function(){var init_hidden_children=function(element,hidden_children)
{var first_time=true;element.click(function(){var open=element.hasClass('children-hidden');var elements=$($.map(hidden_children,function(el){return'.tf-interface-option.'+el;}).join(', '));if(open){element.removeClass('children-hidden');(first_time?elements.show():elements.slideDown());}else{element.addClass('children-hidden');(first_time?elements.hide():elements.slideUp());}
first_time=false;}).trigger('click');};$('div.tf-interface-option[tf_hidden_children]').each(function()
{try{var hidden_children=$.parseJSON($(this).attr('tf_hidden_children'));if(!hidden_children.length){return;}}catch(e){console.log('error parsing "tf_hidden_children" attribute on element with class="'+$(this).attr('class')+'"');return;}
init_hidden_children($('.tf-interface-hidden-children',this).first(),hidden_children);});})();$('body').on('click','.tf_checkbox_switch:not(.disabled)',function(){$(this).toggleClass('on');var helement=$("input.checkbox_default_hidden_value",$(this).parent());if(helement.length){if((helement.attr('name')!==undefined)&&helement.attr('name').length){helement.attr('hiddenname',helement.attr('name'));helement.removeAttr('name');}else{helement.attr('name',helement.attr('hiddenname'));helement.removeAttr('hiddenname');}}});tf_optionize();});function showLoading(){jQuery('#tfuse-ajax-loading-img').fadeIn().center();}
function hideLoading(){jQuery('#tfuse-ajax-loading-img').fadeOut('fast');}
function showFinishedLoading(){var success_msg=jQuery('#tfuse-popup-save');hideLoading();success_msg.fadeIn().center();window.setTimeout(function(){success_msg.fadeOut();},2000);}
function showFailLoading(){var warning_msg=jQuery('#tfuse-popup-fail');hideLoading();warning_msg.fadeIn().center();window.setTimeout(function(){warning_msg.fadeOut();},2000);}
function thumb_link(url){var im_parts;if(tf_script.blog_id!=undefined){im_parts=url.split('/files/');if(im_parts[1]!=undefined)
url=tf_script.network_site_url+'blogs.dir/'+tf_script.blog_id+'/files/'+im_parts[1];}
return url;}
function opt_get(optid,context){var $=jQuery;if(context==undefined)
context=$('body');out='';if($('[name="'+optid+'"]',context).length>0){$obj=$('[name="'+optid+'"]',context);if($obj.is('input[type="radio"]')){out=$obj.filter(':checked').val();if(out==undefined)
out='';return out;}
else if($obj.is('input[type="checkbox"]')){out=$obj.filter(':checked').val();if(out==undefined)
out='false';return out;}
out=$obj.val();if(out==undefined)
out='';}
else if($('[name="'+optid+'[]"]',context).length>0){out=[];$('[name="'+optid+'[]"]',context).each(function(){val=$(this).val();if(val==undefined)
val='';out.push(val);});}
return out;}
function opt_set(optid,val){var $=jQuery;if($('[name="'+optid+'"]').length>0){$obj=$('[name="'+optid+'"]');if($obj.is('input[type="radio"]')){$obj.filter('[value="'+val+'"]').prop("checked",true).trigger('change');curr=$obj.filter(':checked');curr.parents('.formcontainer').find('.thumb_radio_over').removeClass('tfuse-meta-radio-img-selected');curr.parents('.tfuse-meta-radio-img-box').find('.thumb_radio_over').addClass('tfuse-meta-radio-img-selected');return true;}
$obj.val(val);if($obj.is(':hidden')==true)
$obj.change();}
else if($('[name="'+optid+'[]"]').length>0){$('[name="'+optid+'[]"]').each(function(i){$(this).val(val[i]);});}
return true;}
function opt_reset(optid,context){var $=jQuery;if(context==undefined)
context=$('body');if($('[name="'+optid+'"]',context).length>0){$obj=$('[name="'+optid+'"]',context);if($obj.is('input[type="radio"]')){$('[name="'+optid+'"]').prop("checked",false).attr('checked',false).parents('.formcontainer').find('.thumb_radio_over').removeClass('tfuse-meta-radio-img-selected');return true;}
$obj.val('');}
else if($('[name="'+optid+'[]"]',context).length>0){$('[name="'+optid+'[]"]',context).each(function(i){$(this).val('');});}
return true;}
function killTheUnloadEvent(e)
{e.stopPropagation();e.stopImmediatePropagation();return false;}
function tfuse_thumb_load(itemurl,el){var $=jQuery;var thumb,link,vals={};var external=RegExp('^((f|ht)tps?:)?//(?!'+location.host+')');if(external.test(itemurl))
{thumb=link=itemurl;vals={};}
else
{var imgurl=itemurl;var blog_id=tf_script.blog_id;if(blog_id)
{var imageParts=imgurl.split('/files/');if(imageParts[1]!=null)
imgurl='/blogs.dir/'+blog_id+'/files/'+imageParts[1];}
link=tf_script.template_directory_uri+'/framework/timthumb/timthumb.php';thumb=link+'?w=45&amp;h=45&amp;zc=1&amp;src='+imgurl;vals={w:'45',h:'45',zc:'1',src:imgurl};}
$(el).html('<img src="'+tf_script.template_directory_uri+'/framework/static/images/loading_16x16.gif" class="loading_thumb_ico" />');$.get(link,vals,function(){$(el).html('<img src="'+tf_script.template_directory_uri+'/framework/static/images/loading_16x16.gif" class="loading_thumb_ico" /><div class="thumb_over"></div><img src="'+thumb+'" width="45" height="45" class="loading_thumb" />');}).error(function(){var ext=link.split('.').pop().toLowerCase();switch(ext){case'jpg':case'gif':case'png':case'ico':if($(el).html())$(el).html('<div class="thumb_over"></div><img src="'+thumb+'" width="45" height="45" />').find('div.thumb_over').show();break;default:$(el).html('');}}).complete(function(){if($(el).html())$(el).html('<div class="thumb_over"></div><img src="'+thumb+'" width="45" height="45" />').find('div.thumb_over').show();});$(el).bt({contentSelector:function(){return'<img src="'+itemurl+'" style="max-width:400px" />'},padding:'4px',positions:['top','left'],fill:'white',width:'400px',strokeStyle:'#e0e0e0',spikeLength:10,strokeWidth:1});}
function tf_optionize(){var $=jQuery;$('.tf_color_select').each(function(){if($(this).prop('initialized')!==true){$(this).prop('initialized',true);$(this).ColorPicker({onSubmit:function(hsb,hex,rgb,el){$(el).val('#'+hex);$(el).ColorPickerHide();},onBeforeShow:function(){$(this).ColorPickerSetColor(this.value);},onChange:function(hsb,hex,rgb){$('.tf_color_selected').val('#'+hex).change();}});$(this).on('focus','.tf_color_select',function(){$('.tf_color_selected').removeClass('tf_color_selected');$(this).addClass('tf_color_selected');});}});$('.tf_date_select').each(function(){var formatd=($(this).attr('rel'));$(this).datepicker({dateFormat:formatd});});$('img.tfuse-meta-radio-img-img').each(function(){if($(this).prop('initialized')!==true){$(this).prop('initialized',true);$(this).click(function(){$(this).parents('div.formcontainer, tr.tfuse-tax-form-field').find('div.thumb_radio_over').removeClass('tfuse-meta-radio-img-selected');opt_set($(this).prevAll('.tfuse-meta-radio-img-label').find('input:radio').attr('name'),$(this).attr('optval'));$(this).prev('div.thumb_radio_over').addClass('tfuse-meta-radio-img-selected');});}});$('.tfuse_suggest_input').each(function(){if($(this).prop('initialized')!==true){$(this).prop('initialized',true);$(this).one('focus',function(){var multiple_box=$(this).parent('.multiple_box');var multiple_box_selected_titles=multiple_box.find('div.multiple_box_selected_titles');var li=multiple_box_selected_titles.find('span:eq(0)');var input_id=$(this).attr('id');var name=$(this).attr('rel');var type=($(this).hasClass('tfuse_taxonomy_type'))?'taxonomy':'post';$('#'+input_id).suggest('admin-ajax.php?action=tfuse_get_suggest&type='+type+'&name='+name,{resultsClass:'tfuse_ac_results '+type+input_id,selectClass:'tfuse_ac_over',matchClass:'tfuse_ac_match',onSelect:function()
{var selected=$('.tfuse_ac_results.'+type+input_id+' .tfuse_ac_over');var sel_id=selected.children('a').attr('rel');var saved_val=multiple_box.children('input:hidden');var arrvals=saved_val.val().split(',');if($.inArray(sel_id,arrvals)==-1&&sel_id!=0)
{var new_li=li.clone().removeAttr('style');new_li.find('a').attr('rel',sel_id);new_li.append(selected.text());new_li.appendTo(multiple_box_selected_titles);new_vals=(saved_val.val())?saved_val.val()+','+sel_id:sel_id;old_vals=saved_val.val();saved_val.val(new_vals);if(new_vals!=old_vals)
saved_val.change();$(this).val('');$('#'+input_id).trigger('onselect',[{'value':sel_id}]);}
else
{$(this).blur().val('Already exists, try another ... ');}}});}).focus(function(){$(this).removeClass('tfuse_input_help_text').addClass('edit').val('');}).blur(function(){$(this).addClass('tfuse_input_help_text').removeClass('edit').val('Type here to search');});jQuery(document).ajaxSend(function(evt,request,settings){if(settings.url.match(/admin-ajax.php\?action=tfuse_get_suggest/gi)){$('.tfuse_suggest_input.edit').addClass('tfuse_ac_loading');}});jQuery(document).ajaxComplete(function(evt,request,settings){if(settings.url.match(/admin-ajax.php\?action=tfuse_get_suggest/gi)){$('.tfuse_suggest_input.edit').removeClass('tfuse_ac_loading');}});}});if(typeof tf_optionize.one_time=='undefined'){$('body').on('click','a.remove_multi_items',function()
{var multiple_box=$(this).parents('.multiple_box');var saved_val=multiple_box.children('input:hidden');var arrvals=saved_val.val().split(',');var id=$(this).attr('rel');arrvals=$.grep(arrvals,function(n,i)
{return n!=id;});new_vals=arrvals.join(',');old_vals=saved_val.val();saved_val.val(new_vals);if(new_vals!=old_vals)
saved_val.change();$(this).parent('span').remove();return false;});var formfield,tab,media,formID,tfuse_title='',button,no_tabs;$('.upload_button').live('click',function()
{button=$(this);formfield=$(this).attr('id').replace('_button','');media='image';media=($('#'+formfield).length>0)?$('#'+formfield).attr('rel'):media;formID=$(this).attr('rel');tab=$(this).attr('tab')||'type';var change=!$(this).hasClass('sliders');$.ajax({url:ajaxurl,type:'post',dataType:'json',data:'action=change_gallery_id&post_id='+formID+'&input_id='+formfield+'&media='+media+'&change='+change,success:function(response){formID=response.id;button.attr('rel',formID);no_tabs=(button.hasClass('multi_upload'))?'&amp;no_tabs=1':'';if(tfuse_title=$(this).parents('.option-inner').find('label').text()){}
else if(tfuse_title=$(this).parents('.form-field').find('label').text()){}
tb_show(tfuse_title,'media-upload.php?post_id='+formID+'&amp;type='+media+'&amp;formfield='+formfield+'&amp;tab='+tab+no_tabs+'&amp;TB_iframe=1');$('#TB_window,#TB_overlay,#TB_HideSelect').one('unload',killTheUnloadEvent);if(button.closest('.upload_button_div').find('.attachment_num').length)
_content=$('#TB_window').find('iframe').contents();no_tabs=no_tabs.replace('&amp;','&');$($('#TB_window').find('iframe')).load(function(){_image_form=$(this).contents().find('#image-form');_image_form.attr('action',_image_form.attr('action')+no_tabs);_gallery_form=$(this).contents().find('#gallery-form');_gallery_form.attr('action',_gallery_form.attr('action')+no_tabs);});$("#TB_window").bind('tb_unload',function(){with_images='Add/Edit Images';no_images='Upload Images';attachments=$(this).find('iframe').contents().find('#attachments-count');_placeholder=button.closest('.upload_button_div');if(attachments.length){_placeholder.find('.attachment_num').html(attachments.html());if(button.hasClass('multi_upload'))
button.html(with_images);button.attr('tab','gallery');}else{_placeholder.find('.attachment_num').html(0);if(button.hasClass('multi_upload'))
button.html(no_images);button.attr('tab','type');}});}});return false;});window.original_send_to_editor=window.send_to_editor;window.send_to_editor=function(html)
{if(formfield)
{var itemurl,el,type='image';if(typeof $(html).attr('src')!='undefined')
{itemurl=$(html).attr('src');}
else if($(html).html(html).find('img').length>0)
{itemurl=$('img',html).attr('src');}else{itemurl=$(html).attr('href');type='file';}
if(typeof itemurl!='undefined'&&media=='image'&&type=='image')
{var upload_el_metabox=$('#'+formfield).parents('div.option-upload').find('div.uploaded_thumb');var upload_el_taxonomy=$('#'+formfield).parents('tr').find('div.uploaded_thumb');if(upload_el_metabox.length>0){el=upload_el_metabox;}
else if(upload_el_taxonomy.length>0){el=upload_el_taxonomy;}
tfuse_thumb_load(itemurl,el);$obj=$('input[name="'+formfield+'"]');curr_value=$obj.val();$obj.val(itemurl);if(curr_value!=itemurl)
$obj.change();}else if(typeof itemurl!='undefined'&&media=='file')
{$obj=$('input[name="'+formfield+'"]');curr_value=$obj.val();$obj.val(itemurl);if(curr_value!=itemurl)
$obj.change();}
tb_remove();}
else
{window.original_send_to_editor(html);}
formfield=itemurl=el='';}
$('div.uploaded_thumb[rel]').each(function()
{tfuse_thumb_load($(this).attr('rel'),$(this));});tf_optionize.one_time=true;}}
/* end of /whb/wp-content/themes/envision-parent/framework/static/javascript/tfuse-domready.js */
(function($){var ColorPicker=function(){var
ids={},inAction,charMin=65,visible,tpl='<div class="colorpicker"><div class="colorpicker_color"><div><div></div></div></div><div class="colorpicker_hue"><div></div></div><div class="colorpicker_new_color"></div><div class="colorpicker_current_color"></div><div class="colorpicker_hex"><input type="text" maxlength="6" size="6" /></div><div class="colorpicker_rgb_r colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_rgb_g colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_rgb_b colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_h colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_s colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_b colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_submit"></div></div>',defaults={eventName:'click',onShow:function(){},onBeforeShow:function(){},onHide:function(){},onChange:function(){},onSubmit:function(){},color:'ff0000',livePreview:true,flat:false},fillRGBFields=function(hsb,cal){var rgb=HSBToRGB(hsb);$(cal).data('colorpicker').fields.eq(1).val(rgb.r).end().eq(2).val(rgb.g).end().eq(3).val(rgb.b).end();},fillHSBFields=function(hsb,cal){$(cal).data('colorpicker').fields.eq(4).val(hsb.h).end().eq(5).val(hsb.s).end().eq(6).val(hsb.b).end();},fillHexFields=function(hsb,cal){$(cal).data('colorpicker').fields.eq(0).val(HSBToHex(hsb)).end();},setSelector=function(hsb,cal){$(cal).data('colorpicker').selector.css('backgroundColor','#'+HSBToHex({h:hsb.h,s:100,b:100}));$(cal).data('colorpicker').selectorIndic.css({left:parseInt(150*hsb.s/100,10),top:parseInt(150*(100-hsb.b)/100,10)});},setHue=function(hsb,cal){$(cal).data('colorpicker').hue.css('top',parseInt(150-150*hsb.h/360,10));},setCurrentColor=function(hsb,cal){$(cal).data('colorpicker').currentColor.css('backgroundColor','#'+HSBToHex(hsb));},setNewColor=function(hsb,cal){$(cal).data('colorpicker').newColor.css('backgroundColor','#'+HSBToHex(hsb));},keyDown=function(ev){var pressedKey=ev.charCode||ev.keyCode||-1;if((pressedKey>charMin&&pressedKey<=90)||pressedKey==32){return false;}
var cal=$(this).parent().parent();if(cal.data('colorpicker').livePreview===true){change.apply(this);}},change=function(ev){var cal=$(this).parent().parent(),col;if(this.parentNode.className.indexOf('_hex')>0){cal.data('colorpicker').color=col=HexToHSB(fixHex(this.value));}else if(this.parentNode.className.indexOf('_hsb')>0){cal.data('colorpicker').color=col=fixHSB({h:parseInt(cal.data('colorpicker').fields.eq(4).val(),10),s:parseInt(cal.data('colorpicker').fields.eq(5).val(),10),b:parseInt(cal.data('colorpicker').fields.eq(6).val(),10)});}else{cal.data('colorpicker').color=col=RGBToHSB(fixRGB({r:parseInt(cal.data('colorpicker').fields.eq(1).val(),10),g:parseInt(cal.data('colorpicker').fields.eq(2).val(),10),b:parseInt(cal.data('colorpicker').fields.eq(3).val(),10)}));}
if(ev){fillRGBFields(col,cal.get(0));fillHexFields(col,cal.get(0));fillHSBFields(col,cal.get(0));}
setSelector(col,cal.get(0));setHue(col,cal.get(0));setNewColor(col,cal.get(0));cal.data('colorpicker').onChange.apply(cal,[col,HSBToHex(col),HSBToRGB(col)]);},blur=function(ev){var cal=$(this).parent().parent();cal.data('colorpicker').fields.parent().removeClass('colorpicker_focus');},focus=function(){charMin=this.parentNode.className.indexOf('_hex')>0?70:65;$(this).parent().parent().data('colorpicker').fields.parent().removeClass('colorpicker_focus');$(this).parent().addClass('colorpicker_focus');},downIncrement=function(ev){var field=$(this).parent().find('input').focus();var current={el:$(this).parent().addClass('colorpicker_slider'),max:this.parentNode.className.indexOf('_hsb_h')>0?360:(this.parentNode.className.indexOf('_hsb')>0?100:255),y:ev.pageY,field:field,val:parseInt(field.val(),10),preview:$(this).parent().parent().data('colorpicker').livePreview};$(document).bind('mouseup',current,upIncrement);$(document).bind('mousemove',current,moveIncrement);},moveIncrement=function(ev){ev.data.field.val(Math.max(0,Math.min(ev.data.max,parseInt(ev.data.val+ev.pageY-ev.data.y,10))));if(ev.data.preview){change.apply(ev.data.field.get(0),[true]);}
return false;},upIncrement=function(ev){change.apply(ev.data.field.get(0),[true]);ev.data.el.removeClass('colorpicker_slider').find('input').focus();$(document).unbind('mouseup',upIncrement);$(document).unbind('mousemove',moveIncrement);return false;},downHue=function(ev){var current={cal:$(this).parent(),y:$(this).offset().top};current.preview=current.cal.data('colorpicker').livePreview;$(document).bind('mouseup',current,upHue);$(document).bind('mousemove',current,moveHue);},moveHue=function(ev){change.apply(ev.data.cal.data('colorpicker').fields.eq(4).val(parseInt(360*(150-Math.max(0,Math.min(150,(ev.pageY-ev.data.y))))/150,10)).get(0),[ev.data.preview]);return false;},upHue=function(ev){fillRGBFields(ev.data.cal.data('colorpicker').color,ev.data.cal.get(0));fillHexFields(ev.data.cal.data('colorpicker').color,ev.data.cal.get(0));$(document).unbind('mouseup',upHue);$(document).unbind('mousemove',moveHue);return false;},downSelector=function(ev){var current={cal:$(this).parent(),pos:$(this).offset()};current.preview=current.cal.data('colorpicker').livePreview;$(document).bind('mouseup',current,upSelector);$(document).bind('mousemove',current,moveSelector);},moveSelector=function(ev){change.apply(ev.data.cal.data('colorpicker').fields.eq(6).val(parseInt(100*(150-Math.max(0,Math.min(150,(ev.pageY-ev.data.pos.top))))/150,10)).end().eq(5).val(parseInt(100*(Math.max(0,Math.min(150,(ev.pageX-ev.data.pos.left))))/150,10)).get(0),[ev.data.preview]);return false;},upSelector=function(ev){fillRGBFields(ev.data.cal.data('colorpicker').color,ev.data.cal.get(0));fillHexFields(ev.data.cal.data('colorpicker').color,ev.data.cal.get(0));$(document).unbind('mouseup',upSelector);$(document).unbind('mousemove',moveSelector);return false;},enterSubmit=function(ev){$(this).addClass('colorpicker_focus');},leaveSubmit=function(ev){$(this).removeClass('colorpicker_focus');},clickSubmit=function(ev){var cal=$(this).parent();var col=cal.data('colorpicker').color;cal.data('colorpicker').origColor=col;setCurrentColor(col,cal.get(0));cal.data('colorpicker').onSubmit(col,HSBToHex(col),HSBToRGB(col),cal.data('colorpicker').el);},show=function(ev){var cal=$('#'+$(this).data('colorpickerId'));cal.data('colorpicker').onBeforeShow.apply(this,[cal.get(0)]);var pos=$(this).offset();var viewPort=getViewport();var top=pos.top+this.offsetHeight;var left=pos.left;if(top+176>viewPort.t+viewPort.h){top-=this.offsetHeight+176;}
if(left+356>viewPort.l+viewPort.w){left-=356;}
cal.css({left:left+'px',top:top+'px'});if(cal.data('colorpicker').onShow.apply(this,[cal.get(0)])!=false){cal.show();}
$(document).bind('mousedown',{cal:cal},hide);return false;},hide=function(ev){if(!isChildOf(ev.data.cal.get(0),ev.target,ev.data.cal.get(0))){if(ev.data.cal.data('colorpicker').onHide.apply(this,[ev.data.cal.get(0)])!=false){ev.data.cal.hide();}
$(document).unbind('mousedown',hide);}},isChildOf=function(parentEl,el,container){if(parentEl==el){return true;}
if(parentEl.contains){return parentEl.contains(el);}
if(parentEl.compareDocumentPosition){return!!(parentEl.compareDocumentPosition(el)&16);}
var prEl=el.parentNode;while(prEl&&prEl!=container){if(prEl==parentEl)
return true;prEl=prEl.parentNode;}
return false;},getViewport=function(){var m=document.compatMode=='CSS1Compat';return{l:window.pageXOffset||(m?document.documentElement.scrollLeft:document.body.scrollLeft),t:window.pageYOffset||(m?document.documentElement.scrollTop:document.body.scrollTop),w:window.innerWidth||(m?document.documentElement.clientWidth:document.body.clientWidth),h:window.innerHeight||(m?document.documentElement.clientHeight:document.body.clientHeight)};},fixHSB=function(hsb){return{h:Math.min(360,Math.max(0,hsb.h)),s:Math.min(100,Math.max(0,hsb.s)),b:Math.min(100,Math.max(0,hsb.b))};},fixRGB=function(rgb){return{r:Math.min(255,Math.max(0,rgb.r)),g:Math.min(255,Math.max(0,rgb.g)),b:Math.min(255,Math.max(0,rgb.b))};},fixHex=function(hex){var len=6-hex.length;if(len>0){var o=[];for(var i=0;i<len;i++){o.push('0');}
o.push(hex);hex=o.join('');}
return hex;},HexToRGB=function(hex){var hex=parseInt(((hex.indexOf('#')>-1)?hex.substring(1):hex),16);return{r:hex>>16,g:(hex&0x00FF00)>>8,b:(hex&0x0000FF)};},HexToHSB=function(hex){return RGBToHSB(HexToRGB(hex));},RGBToHSB=function(rgb){var hsb={h:0,s:0,b:0};var min=Math.min(rgb.r,rgb.g,rgb.b);var max=Math.max(rgb.r,rgb.g,rgb.b);var delta=max-min;hsb.b=max;if(max!=0){}
hsb.s=max!=0?255*delta/max:0;if(hsb.s!=0){if(rgb.r==max){hsb.h=(rgb.g-rgb.b)/delta;}else if(rgb.g==max){hsb.h=2+(rgb.b-rgb.r)/delta;}else{hsb.h=4+(rgb.r-rgb.g)/delta;}}else{hsb.h=-1;}
hsb.h*=60;if(hsb.h<0){hsb.h+=360;}
hsb.s*=100/255;hsb.b*=100/255;return hsb;},HSBToRGB=function(hsb){var rgb={};var h=Math.round(hsb.h);var s=Math.round(hsb.s*255/100);var v=Math.round(hsb.b*255/100);if(s==0){rgb.r=rgb.g=rgb.b=v;}else{var t1=v;var t2=(255-s)*v/255;var t3=(t1-t2)*(h%60)/60;if(h==360)h=0;if(h<60){rgb.r=t1;rgb.b=t2;rgb.g=t2+t3}
else if(h<120){rgb.g=t1;rgb.b=t2;rgb.r=t1-t3}
else if(h<180){rgb.g=t1;rgb.r=t2;rgb.b=t2+t3}
else if(h<240){rgb.b=t1;rgb.r=t2;rgb.g=t1-t3}
else if(h<300){rgb.b=t1;rgb.g=t2;rgb.r=t2+t3}
else if(h<360){rgb.r=t1;rgb.g=t2;rgb.b=t1-t3}
else{rgb.r=0;rgb.g=0;rgb.b=0}}
return{r:Math.round(rgb.r),g:Math.round(rgb.g),b:Math.round(rgb.b)};},RGBToHex=function(rgb){var hex=[rgb.r.toString(16),rgb.g.toString(16),rgb.b.toString(16)];$.each(hex,function(nr,val){if(val.length==1){hex[nr]='0'+val;}});return hex.join('');},HSBToHex=function(hsb){return RGBToHex(HSBToRGB(hsb));},restoreOriginal=function(){var cal=$(this).parent();var col=cal.data('colorpicker').origColor;cal.data('colorpicker').color=col;fillRGBFields(col,cal.get(0));fillHexFields(col,cal.get(0));fillHSBFields(col,cal.get(0));setSelector(col,cal.get(0));setHue(col,cal.get(0));setNewColor(col,cal.get(0));};return{init:function(opt){opt=$.extend({},defaults,opt||{});if(typeof opt.color=='string'){opt.color=HexToHSB(opt.color);}else if(opt.color.r!=undefined&&opt.color.g!=undefined&&opt.color.b!=undefined){opt.color=RGBToHSB(opt.color);}else if(opt.color.h!=undefined&&opt.color.s!=undefined&&opt.color.b!=undefined){opt.color=fixHSB(opt.color);}else{return this;}
return this.each(function(){if(!$(this).data('colorpickerId')){var options=$.extend({},opt);options.origColor=opt.color;var id='collorpicker_'+parseInt(Math.random()*1000);$(this).data('colorpickerId',id);var cal=$(tpl).attr('id',id);if(options.flat){cal.appendTo(this).show();}else{cal.appendTo(document.body);}
options.fields=cal.find('input').bind('keyup',keyDown).bind('change',change).bind('blur',blur).bind('focus',focus);cal.find('span').bind('mousedown',downIncrement).end().find('>div.colorpicker_current_color').bind('click',restoreOriginal);options.selector=cal.find('div.colorpicker_color').bind('mousedown',downSelector);options.selectorIndic=options.selector.find('div div');options.el=this;options.hue=cal.find('div.colorpicker_hue div');cal.find('div.colorpicker_hue').bind('mousedown',downHue);options.newColor=cal.find('div.colorpicker_new_color');options.currentColor=cal.find('div.colorpicker_current_color');cal.data('colorpicker',options);cal.find('div.colorpicker_submit').bind('mouseenter',enterSubmit).bind('mouseleave',leaveSubmit).bind('click',clickSubmit);fillRGBFields(options.color,cal.get(0));fillHSBFields(options.color,cal.get(0));fillHexFields(options.color,cal.get(0));setHue(options.color,cal.get(0));setSelector(options.color,cal.get(0));setCurrentColor(options.color,cal.get(0));setNewColor(options.color,cal.get(0));if(options.flat){cal.css({position:'relative',display:'block'});}else{$(this).bind(options.eventName,show);}}});},showPicker:function(){return this.each(function(){if($(this).data('colorpickerId')){show.apply(this);}});},hidePicker:function(){return this.each(function(){if($(this).data('colorpickerId')){$('#'+$(this).data('colorpickerId')).hide();}});},setColor:function(col){if(typeof col=='string'){col=HexToHSB(col);}else if(col.r!=undefined&&col.g!=undefined&&col.b!=undefined){col=RGBToHSB(col);}else if(col.h!=undefined&&col.s!=undefined&&col.b!=undefined){col=fixHSB(col);}else{return this;}
return this.each(function(){if($(this).data('colorpickerId')){var cal=$('#'+$(this).data('colorpickerId'));cal.data('colorpicker').color=col;cal.data('colorpicker').origColor=col;fillRGBFields(col,cal.get(0));fillHSBFields(col,cal.get(0));fillHexFields(col,cal.get(0));setHue(col,cal.get(0));setSelector(col,cal.get(0));setCurrentColor(col,cal.get(0));setNewColor(col,cal.get(0));}});}};}();$.fn.extend({ColorPicker:ColorPicker.init,ColorPickerHide:ColorPicker.hidePicker,ColorPickerShow:ColorPicker.showPicker,ColorPickerSetColor:ColorPicker.setColor});})(jQuery);
/* end of /whb/wp-content/themes/envision-parent/framework/static/javascript/colorpicker.js */
